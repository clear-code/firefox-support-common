<!--
  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.
-->

PRETEXT-1: 前提条件

    :1: 環境

    - 対象のFirefoxのバージョンは {{firefox_version}} とする。
    - 検証環境は {{windows_version}} とする。
    - 参照する設定資料は {{configuration_sheet_name}} とする。

    :2: 基本の設定

    - メタインストーラの名称は `{{meta_installer_name}}`、ファイル名は `{{meta_installer_file_name}}` とする。
    - メタインストーラの表示バージョンは {{meta_installer_version}} とする。
    - Firefoxのインストール先は  
      `{{install_path}}`  
      {{#install_path_32bit}}
      （32bit環境では `{{install_path_32bit}}`）
      {{/install_path_32bit}}
      とする。
    - デスクトップのショートカットは  
      `{{desktop_shortcut_path}}`  {{#desktop_shortcut_path_32bit}}
      （32bit環境では `{{desktop_shortcut_path_32bit}}`）  {{/desktop_shortcut_path_32bit}}
      に作成するものとする。
    - スタートメニューのショートカットは  
      `{{start_menu_shortcut_path}}`  {{#start_menu_shortcut_path_32bit}}
      （32bit環境では `{{start_menu_shortcut_path_32bit}}`）  {{/start_menu_shortcut_path_32bit}}
      に作成するものとする。
    - 検証環境が新規に用意した環境である場合、検証環境のWindowsは以下の状態を整えておく。
        - ワークグループ名： `ワークグループ`（日本語名）
        - ローカル管理者アカウント： `管理者`（日本語名、パスワードは `administrator`）
        - ローカル一般アカウント： `ユーザー`（日本語名、パスワードは `user`）（検証作業で主に使用するログオンユーザー）

    :3: 検証の準備
    - 検証環境からインターネット上のWebサイトに接続できる状態にしておく。フィルタリングソフトウェア、ファイアウォール等で接続が制限されている場合、一部    の検証を実施できない場合がある。
    - 以下のページから検証用テストケース集をダウンロードし、検証環境に用意しておく（テストケースリストは `testcases/index.html` に存在する）。
    
            https://github.com/clear-code/firefox-support-common/
    


Install-1: インストーラの表示名

    :1: Fx Meta Installer（既定）

    - `FxMetaInstaller*.exe` が作成済みの状態にする。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - Fx Meta Installer
    - 検証用ユーザーとして `FxMetaInstaller*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「Fx Meta Installer」がインストールされている。

    :2: 任意の名前

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」がインストールされている。

Install-2: インストーラのファイル名

    :1: FxMetaInstaller

    - メタインストーラ作成キット一式を用意する。
    - **確認**
        - メタインストーラ作成キット一式の格納フォルダ名が `FxMetaInstaller` で始まる。

    :2: 任意の名前

    - メタインストーラ作成キット一式を用意する。
    - **確認**
        - メタインストーラ作成キット一式の格納フォルダ名が `{{meta_installer_file_name}}` で始まる。

Install-3: インストーラの動作モード

    :1: ウィザードを表示し、操作確認を求める

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - メタインストーラのウィザードが表示され、操作確認が求められない。

    :2: ウィザードを表示し、操作確認を求めない（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - メタインストーラのウィザードが表示され、操作なしにインストールが完了する。

    :3: ウィザードを一切表示しない

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - メタインストーラのウィザードが表示されない。

Install-4: インストール完了後のメッセージ

    :1: 表示しない（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - インストール完了後に完了を示すメッセージが表示されない。

    :2: 表示する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - インストール完了後に「{{finish_title}}」のタイトルで「{{finish_message}}」のメッセージが表示される。

Install-5: インストール完了後の再起動要求

    :1: 表示しない（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - インストール完了後に再起動を求めるメッセージが表示されない。

    :2: 表示する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - インストール完了後に「{{restart_title}}」のタイトルで「{{restart_message}}」のメッセージが表示される。

Install-6: インストーラのウィザードの表示言語

    :1: 日本語（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - メタインストーラのウィザードが日本語表示になっている。

    :2: 英語

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - メタインストーラのウィザードが英語表示になっている。

Install-7: Firefox/Thunderbirdの同梱

    :1: 同梱しない（既定）

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\firefox.exe`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit\firefox.exe}}`）{{/install_path_32bit}}
          が存在しない。

    :2: 指定バージョンを同梱する

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\{{exe_name}}.exe`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{exe_name}}.exe`）{{/install_path_32bit}}
          が存在する。
        - `{{exe_name}}.exe` と同じ位置にある `application.ini` に記載されているFirefoxのバージョンが {{firefox_version}} である。

Install-8: Firefox/Thunderbirdのインストール先

    :1: 既定のインストール先（既定）

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path_base}}\Mozilla Firefox`
          {{#install_path_base_32bit}}（32bit環境では `{{install_path_base_32bit}}\Mozilla Firefox`）{{/install_path_base_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path_base}}\Mozilla Firefox\{{exe_name}}.exe`
          {{#install_path_base_32bit}}（32bit環境では `{{install_path_base_32bit}}\Mozilla Firefox\{{exe_name}}.exe`）{{/install_path_base_32bit}}
          が存在する。

    :2: 任意のインストール先

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\{{exe_name}}.exe`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{exe_name}}.exe`）{{/install_path_32bit}}
          が存在する。

Install-9: メタインストーラの表示バージョン

    :1: 更新しない（既定）

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」のバージョンが空である。

    :2: 指定する

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」のバージョンが「{{meta_installer_version}}」と表示されている。

Install-10: スタートメニュー、タスクバー上のショートカットの更新

    :1: 更新しない（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\StartMenu` を開く。
    - `{{install_path}}\{{exe_name}}.exe`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{exe_name}}.exe`）{{/install_path_32bit}}
      のショートカットをフォルダ内に作成し、名前を `Firefox` に変更する。
    - `Firefox` のショートカットを右クリックし、プロパティを開く。
    - 「リンク先」欄末尾に、半角スペースを空けて `about:blank?Install-10-1` を追記する。
    - インストールされたFirefoxを起動する。
    - タスクバー上のアイコンを右クリックして「タスクバーにピン留めする」を選択する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - `Firefox` のショートカットを右クリックし、プロパティを開く。
    - 「リンク先」欄末尾に、半角スペースを空けて `about:blank?Install-10-1` を追記する。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\StartMenu` を開く。
    - `Firefox` のショートカットを右クリックし、プロパティを開く。
    - **確認**
        - 「リンク先」欄末尾に `about:blank?Install-10-1` と記載されている。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - `Firefox` のショートカットを右クリックし、プロパティを開く。
    - **確認**
        - 「リンク先」欄末尾に `about:blank?Install-10-1` と記載されている。

    :2: 更新する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\StartMenu` を開く。
    - `{{install_path}}\{{exe_name}}.exe`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{exe_name}}.exe`）{{/install_path_32bit}}
      のショートカットをフォルダ内に作成し、名前を `Firefox` に変更する。
    - `Firefox` のショートカットを右クリックし、プロパティを開く。
    - 「リンク先」欄末尾に、半角スペースを空けて `about:blank?Install-10-1` を追記する。
    - インストールされたFirefoxを起動する。
    - タスクバー上のアイコンを右クリックして「タスクバーにピン留めする」を選択する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - `Firefox` のショートカットを右クリックし、プロパティを開く。
    - 「リンク先」欄末尾に、半角スペースを空けて `about:blank?Install-10-1` を追記する。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\StartMenu` を開く。
    - `Firefox` のショートカットを右クリックし、プロパティを開く。
    - **確認**
        - 「リンク先」欄末尾に `about:blank?Install-10-1` と記載されていない。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - `Firefox` のショートカットを右クリックし、プロパティを開く。
    - **確認**
        - 「リンク先」欄末尾に `about:blank?Install-10-1` と記載されていない。

    :3: 削除のみする

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\StartMenu` を開く。
    - `{{install_path}}\{{exe_name}}.exe`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{exe_name}}.exe`）{{/install_path_32bit}}
      のショートカットをフォルダ内に作成し、名前を `Firefox` に変更する。
    - インストールされたFirefoxを起動する。
    - タスクバー上のアイコンを右クリックして「タスクバーにピン留めする」を選択する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\StartMenu` を開く。
    - **確認**
        - `Firefox` のショートカットが存在しない。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - **確認**
        - `Firefox` のショートカットが存在しない。

Install-11: タスクバー上へのピン留め用ショートカットの作成

    :1: 作成する（既定）

    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - `Firefox` のショートカットがあれば削除する。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - **確認**
        - `Firefox` のショートカットが存在する。

    :2: 作成しない

    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - `Firefox` のショートカットがあれば削除する。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - エクスプローラで `%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned\TaskBar` を開く。
    - **確認**
        - `Firefox` のショートカットが存在しない。

Install-12: 管理者権限の確認

    :1: 確認する（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
    - **確認**
        - 管理者権限を要求される。
    - `管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」がインストールされている。

    :2: 確認しない

    - 検証用ユーザーに対し、権限確認用のフォルダに書き込み権限を与える。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
    - **確認**
        - 管理者権限を要求されない。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」がインストールされている。

    :3: 特定のフォルダで書き込み可否を判断する

    - 検証用ユーザーに対し、権限確認用のフォルダに書き込み権限を与える。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
    - **確認**
        - 管理者権限を要求されない。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」がインストールされている。

Install-13: インストール前のクリーンアップ処理

    :1: 何もしない

    - `{{install_path}}`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
      の位置にフォルダを作成し、`must-be-removed.txt` という名前で空のファイルを置く。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」がインストールされている。
        - `{{install_path}}\must-be-removed.txt`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\must-be-removed.txt`）{{/install_path_32bit}}
          が存在する。

    :2: 旧バージョンのFirefoxを強制的に削除する

    - `{{install_path}}`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
      の位置にフォルダを作成し、`must-be-removed.txt` という名前で空のファイルを置く。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」がインストールされている。
        - `{{install_path}}\must-be-removed.txt`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\must-be-removed.txt`）{{/install_path_32bit}}
          が存在しない。

    :3: 特定のフォルダを消去してから同梱のアプリケーションをインストールする

    AppCleanupDirs=（消去したいフォルダのパス）
    - インストール時のクリーンアップ対象に指定した位置にフォルダを作成し、`must-be-removed.txt` という名前で空のファイルを置く。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「{{meta_installer_name}}」がインストールされている。
        - インストール時のクリーンアップ対象に指定した位置に `must-be-removed.txt` が存在しない。

Install-14: Internet Explorerのコンテキストメニューにコマンドを追加登録する

    :1: 登録しない

    - IEを起動し、Webページ上でコンテキストメニューを開いて、追加のコンテキストメニューが表示されない事を確認する。
        -  もし項目が存在している場合、コマンドプロンプトで
           `reg.exe delete /va /f "HKCU\\Software\Microsoft\Internet Explorer\MenuExt\メニュー項目名"`
           を実行し、Internet Exploerに追加したコンテキストメニュー項目を削除する。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - IEを起動し、Webページ上でコンテキストメニューを開く。
    - **確認**
        - 既定のコンテキストメニュー項目以外表示されない。

    :2: 登録する

    - IEを起動し、Webページ上でコンテキストメニューを開いて、追加のコンテキストメニューが表示されない事を確認する。
        -  もし項目が存在している場合、コマンドプロンプトで
           `reg.exe delete /va /f "HKCU\\Software\Microsoft\Internet Explorer\MenuExt\メニュー項目名"`
           を実行し、Internet Exploerに追加したコンテキストメニュー項目を削除する。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - IEを起動し、Webページ上でコンテキストメニューを開く。
    - **確認**
        - 追加したコンテキストメニュー項目が表示され、実際に機能する。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - IEを起動し、Webページ上でコンテキストメニューを開く。
    - **確認**
        - 追加したコンテキストメニュー項目が多重に表示されていない。

Install-15: Firefoxのインストーラの動作モード

    :1: Firefoxのインストーラをキックする（既定）

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動する。
    - **確認**
        - 「Mozilla Firefox {{firefox_version}}」がインストールされている。
          （ベータ版を用いた検証の場合、バージョン表記は「beta」を除いた数字が期待される。）
        - 旧バージョンからの更新で、両バージョンを併存させない場合、旧バージョンの情報がインストール済みアプリケーションの一覧に独立した項目として表示されない。

    :2: Firefoxのインストーラをキックせず、ファイルの展開と配置のみ行い、元々インストールされていたFirefoxをFirefoxの最新版として維持する

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
    - Firefoxのインストーラを使用し、Firefoxを `{{original_version_install_path}}` 配下にインストールする。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\{{exe_name}}.exe`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{exe_name}}.exe`）{{/install_path_32bit}}
          が存在する。
        - `{{original_version_install_path}}` 配下にFirefoxが存在する。
        - `{{original_version_install_path}}` 配下にカスタマイズ用のファイルが設置されていない。
    - Windowsキーを押しながら「R」を押し、「ファイル名を指定して実行」ダイアログを開く。
    - `firefox.exe` と入力し、実行する。
    - **確認**
        - `{{original_version_install_path}}` 配下のFirefoxが起動する。
    - レジストリエディタを起動し、`{{original_version_install_path}}` 配下のFirefoxが32bit版で且つWindowsが64bit版であれば  
      `HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Mozilla Firefox {{firefox_version}} (x64 ja)`  
      を、そうでなければ  
      `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\Mozilla Firefox {{firefox_version}} (x86 ja)`  
      を開く。
    - **確認**
        - 値 `InstallLocation` のデータが `{{original_version_install_path}}` である。

Install-17: 既存Firefoxとの共存

    :1: その環境で唯一のFirefoxとして使用する（既定）

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
    - メタインストーラを使用せず、Firefoxのインストーラを直接起動し、既定のインストール先にインストールする。
    - Firefoxを起動する。
    - Firefoxを起動し、Firefox上でユーザが変更可能な何らかの設定を変更する。例：
        - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
        - オプション画面の「検索」を開く。
        - 「既定の検索エンジン」を「Google」から「Yahoo！JAPAN」に変更する。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - メタインストーラによってインストールされたFirefoxを起動する。
    - **確認**
        - 先ほど起動したFirefoxで変更した設定が維持されている。例：
            - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
            - オプション画面の「検索」を開く。
            - 「既定の検索エンジン」が「Yahoo！JAPAN」になっている。

    :2: その環境に既存のFirefoxと併用する

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}`）{{/install_path_32bit}}
    - 旧バージョンのメタインストーラもしくはFirefoxのインストーラを使用し、Firefoxを既定のインストール先にインストールする。
    - Firefoxを起動する。
    - Firefoxを起動し、Firefox上でユーザが変更可能な何らかの設定を変更する。例：
        - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
        - オプション画面の「検索」を開く。
        - 「既定の検索エンジン」を「Google」から「Yahoo！JAPAN」に変更する。
    - 今バージョンのメタインストーラ `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして今バージョンのメタインストーラ `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - 今バージョンのメタインストーラによってインストールされたFirefoxを起動する。
    - **確認**
        - 旧バージョンのメタインストーラもしくはFirefoxのインストーラによってインストールされたFirefoxで変更した設定が初期状態になっている。例：
            - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
            - オプション画面の「検索」を開く。
            - 「既定の検索エンジン」が「Google」になっている。
    - Firefoxを終了する。
    - 旧バージョンのメタインストーラもしくはFirefoxのインストーラによってインストールされたFirefoxを起動する。
    - **確認**
        - 旧バージョンのメタインストーラもしくはFirefoxのインストーラによってインストールされたFirefoxで変更した設定が維持されている。例：
            - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
            - オプション画面の「検索」を開く。
            - 「既定の検索エンジン」が「Yahoo！JAPAN」になっている。

Install-18: BrowserSelectorのインストール

    :1: インストールしない（既定）

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - BrowserSelector
    - 以下のファイル、フォルダがあれば削除する。
        - `{{default_install_path_base}}\ClearCode Inc`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit_base}}\ClearCode Inc`）{{/install_path_32bit}}
        - `{{default_install_path_base}}\ClearCode`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit_base}}\ClearCode`）{{/install_path_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{default_install_path_base}}\ClearCode\BrowserSelector\BrowserSelector.exe`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit_base}}\ClearCode\BrowserSelector\BrowserSelector.exe`）{{/install_path_32bit}}
          が存在しない。
        - `{{default_install_path_base}}\ClearCode\BrowserSelector\BrowserSelector.ini`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit_base}}\ClearCode\BrowserSelector\BrowserSelector.ini`）{{/install_path_32bit}}
          が存在しない。


    :2: INIファイルと併せてインストールする

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - BrowserSelector
    - 以下のファイル、フォルダがあれば削除する。
        - `{{default_install_path_base}}\ClearCode Inc`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit_base}}\ClearCode Inc`）{{/install_path_32bit}}
        - `{{default_install_path_base}}\ClearCode`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit_base}}\ClearCode`）{{/install_path_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{default_install_path_base}}\ClearCode\BrowserSelector\BrowserSelector.exe`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit_base}}\ClearCode\BrowserSelector\BrowserSelector.exe`）{{/install_path_32bit}}
          が存在する。
        - `{{default_install_path_base}}\ClearCode\BrowserSelector\BrowserSelector.ini`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit_base}}\ClearCode\BrowserSelector\BrowserSelector.ini`）{{/install_path_32bit}}
          が存在する。


Application-1: デスクトップのショートカット

    :1: 既定の内容で作成（既定）

    - 以下のファイル、フォルダがあれば削除する。
      - デスクトップ上のFirefox起動用ショートカット
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
      - デスクトップ上にFirefox起動用ショートカットが作成されている。
    - ショートカットからFirefoxを起動する。
    - ショートカットからFirefoxの追加起動を試みる。
    - **確認**
        - Firefoxの新しいウィンドウが開かれる。

    :2: 作成しない

    - 以下のファイル、フォルダがあれば削除する。
      - デスクトップ上のFirefox起動用ショートカット
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
      - デスクトップ上にFirefox起動用ショートカットが作成されていない。

    :3: 任意の内容で作成

    - 以下のファイル、フォルダがあれば削除する。
      - デスクトップ上のFirefox起動用ショートカット
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
      - デスクトップ上にFirefox起動用ショートカットが作成されている。
      - ショートカットのアイコンが `fainstall.ini` での指定通りになっている。
    - デスクトップ上のFirefox起動用ショートカットのプロパティを開く。
    - **確認**
      - ショートカットのリンク先が `fainstall.ini` での指定通りになっている。
        （オプションの指定が反映されている）
      - ショートカットの作業フォルダが、リンク先のFirefoxの実行ファイルがあるフォルダのパスになっている。
    - ショートカットからFirefoxを起動する。
    - ショートカットからFirefoxの追加起動を試みる。
    - **確認**
        - オプションに `-no-remote` が含まれる場合、「Firefoxは起動していますが応答しません。」というメッセージが出て、Firefoxの新しいウィンドウが開かれない。
          オプションに `-no-remote` が含まれない場合、Firefoxの新しいウィンドウが開かれる。

Application-2: スタートメニューのショートカット

    :1: 既定の内容で作成（既定）

    - 以下のファイル、フォルダがあれば削除する。
      - スタートメニュー内のFirefox起動用ショートカット
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
      - スタートメニュー内にFirefox起動用ショートカットが作成されている。
    - ショートカットからFirefoxを起動する。
    - ショートカットからFirefoxの追加起動を試みる。
    - **確認**
        - Firefoxの新しいウィンドウが開かれる。

    :2: 作成しない

    - 以下のファイル、フォルダがあれば削除する。
      - スタートメニュー内のFirefox起動用ショートカット
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
      - スタートメニュー内にFirefox起動用ショートカットが作成されていない。

    :3: 任意の内容で作成

    - 以下のファイル、フォルダがあれば削除する。
      - スタートメニュー内のFirefox起動用ショートカット
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
      - スタートメニュー内にFirefox起動用ショートカットが作成されている。
      - ショートカットのアイコンが `fainstall.ini` での指定通りになっている。
    - スタートメニュー内のFirefox起動用ショートカットのプロパティを開く。
    - **確認**
      - ショートカットのリンク先が `fainstall.ini` での指定通りになっている。
        （オプションの指定が反映されている）
      - ショートカットの作業フォルダが、リンク先のFirefoxの実行ファイルがあるフォルダのパスになっている。
    - ショートカットからFirefoxを起動する。
    - ショートカットからFirefoxの追加起動を試みる。
    - **確認**
        - オプションに `-no-remote` が含まれる場合、「Firefoxは起動していますが応答しません。」というメッセージが出て、Firefoxの新しいウィンドウが開かれない。
          オプションに `-no-remote` が含まれない場合、Firefoxの新しいウィンドウが開かれる。

Application-3: クイック起動のショートカット

    :1: 既定の内容で作成（既定）

    - 以下のファイル、フォルダがあれば削除する。
      - Windows Vista以前のクイック起動内のFirefox起動用ショートカット
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
      - Windows Vista以前のクイック起動内にFirefox起動用ショートカットが作成されている。

    :2: 作成しない

    - 以下のファイル、フォルダがあれば削除する。
      - Windows Vista以前のクイック起動内のFirefox起動用ショートカット
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
      - Windows Vista以前のクイック起動内にFirefox起動用ショートカットが作成されていない。

Application-6: プロファイルの位置

    :1: %AppData%内（既定）

    - 以下のファイル、フォルダがあれば削除する。
        - Firefoxのユーザープロファイル（`%AppData%\Mozilla`）
        - Firefoxのテンポラリファイルおよびキャッシュファイル（`%LocalAppData%\Mozilla`）
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Windowsエクスプローラを開き、アドレスバーに `{{special_profile_path}}` と入力してEnterを押す。
    - **確認**
        - フォルダが見つからない（存在しない）。

    :2: 任意の位置

    - 以下のファイル、フォルダがあれば削除する。
        - Firefoxのユーザープロファイル（`%AppData%\Mozilla`）
        - Firefoxのテンポラリファイルおよびキャッシュファイル（`%LocalAppData%\Mozilla`）
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - デスクトップ上にFirefoxの起動用ショートカットが作成された場合、そのプロパティを開く。
    - **確認**
        - 「リンク先」末尾に、プロファイルを指定する以下のオプションのうち、fainstall.iniの指定と一致する物が設定されている。
          ```
          -p {{special_profile_name}}
          ```
          または
          ```
          -profile {{special_profile_path}}\{{special_profile_name}}
          ```
    - スタートメニュー内にFirefoxの起動用ショートカットが作成された場合、そのプロパティを開く。
    - **確認**
        - 「リンク先」末尾に、プロファイルを指定する以下のオプションのうち、fainstall.iniの指定と一致する物が設定されている。
          ```
          -p {{special_profile_name}}
          ```
          または
          ```
          -profile {{special_profile_path}}\{{special_profile_name}}
          ```
    - Windowsエクスプローラを開き、アドレスバーに `{{special_profile_path}}` と入力してEnterを押す。
    - **確認**
        - `{{special_profile_name}}` フォルダが存在する。
        - フォルダの内容は空である。ｃ
    - デスクトップ上またはスタートメニュー内にFirefox起動用ショートカットが作成された場合、そのいずれかを使用してFirefoxを起動する。
      ショートカットが作成されなかった場合、firefox.exeを実行してFirefoxを起動する。
    - デスクトップ上にFirefoxの起動用ショートカットが作成された場合、そのプロパティを開く。
    - **確認**
        - `{{special_profile_path}}\{{special_profile_name}}` に `prefs.js` などのファイルが作成される。



Admin-1: 管理者による設定の制御

    :1: ローカルのファイルで設定する

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path_base}}\Mozilla Firefox`
          {{#install_path_base_32bit}}（32bit環境では `{{install_path_base_32bit}}\Mozilla Firefox`）{{/install_path_base_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\{{mcd_local_file}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{mcd_local_file}}`）{{/install_path_32bit}}
          が存在する。
        - `{{install_path}}\defaults\pref\*.js`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\defaults\pref\*.js`）{{/install_path_32bit}}
          の位置に、`{{mcd_local_file}}` を読み込ませる指定を含むファイルが存在する。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\{{mcd_local_file}}.backup.1`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{mcd_local_file}}.backup.1`）{{/install_path_32bit}}
          が存在する。
        - `{{install_path}}\defaults\pref\*.js.backup.1`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\defaults\pref\*.js.backup.1`）{{/install_path_32bit}}
          が存在する。

    :2: リモートのファイルで設定する

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path_base}}\Mozilla Firefox`
          {{#install_path_base_32bit}}（32bit環境では `{{install_path_base_32bit}}\Mozilla Firefox`）{{/install_path_base_32bit}}
    - リモート設定ファイルを参照できない環境で検証する場合、`{{mcd_local_file}}` の `autoadmin.global_config_url` の参照先URLを `file:///c:/users/public/autoconfig.jsc` または類似のローカルファイルのURLに変更し、当該位置にファイルを設置する。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\{{mcd_local_file}}`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{mcd_local_file}}`）{{/install_path_32bit}}
          が存在する。
        - `{{install_path}}\defaults\pref\*.js`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\defaults\pref\*.js`）{{/install_path_32bit}}
          の位置に、`{{mcd_local_file}}` を読み込ませる指定を含むファイルが存在する。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\{{mcd_local_file}}.backup.1`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\{{mcd_local_file}}.backup.1`）{{/install_path_32bit}}
          が存在する。
        - `{{install_path}}\defaults\pref\*.js.backup.1`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\defaults\pref\*.js.backup.1`）{{/install_path_32bit}}
          が存在する。
    - メタインストーラによって導入されたFirefoxを起動する。
    - `about:profiles` または `about:support` から、現在のユーザープロファイルフォルダを開く。
    - Firefoxを終了する。
    - **確認**
        - ユーザープロファイルフォルダ内に `failover.jsc` が存在する。
        - `failover.jsc` の内容が `autoadmin.global_config_url` の参照先の内容と等しい。

    :3: 設定しない（既定）

    - スタートメニューから `appwiz.cpl` （プログラムの機能と削除）を起動し、以下が存在していればアンインストールする。
        - {{meta_installer_name}}
        - メタインストーラによってインストールされたMozilla Firefox
    - 以下のファイル、フォルダがあれば削除する。
        - `{{install_path_base}}\Mozilla Firefox`
          {{#install_path_base_32bit}}（32bit環境では `{{install_path_base_32bit}}\Mozilla Firefox`）{{/install_path_base_32bit}}
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - **確認**
        - `{{install_path}}\*.cfg`
          {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\*.cfg`）{{/install_path_32bit}}
          が存在しない。

Admin-2: 初回起動時のアドオン導入警告の可否

    :1: 警告する（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - 導入対象のアドオンがない場合、テストケースリストの `{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi` リンクからファイルをダウンロードして、
      `{{install_path}}\browser\extensions\{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\browser\extensions\{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi`）{{/install_path_32bit}}
      に配置する。
    - Firefoxを起動する。
    - **確認**
        - パネルメニューにアドオンの有効化の可否を尋ねる項目が表示されている。

    :2: 警告しない

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - 導入対象のアドオンがない場合、テストケースリストの `{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi` リンクからファイルをダウンロードして、
      `{{install_path}}\browser\extensions\{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\browser\extensions\{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi`）{{/install_path_32bit}}
      に配置する。
    - Firefoxを起動する。
    - **確認**
        - パネルメニューにアドオンの有効化の可否を尋ねる項目が表示されていない。

Admin-4: Mozillaにより署名されていないアドオンのインストールパッケージの使用の可否

    :1: 許可する

    - ポリシー設定から `BlockAboutAddons` を削除し、アドオンマネージャを一時的に有効化しておく。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - アドオンの未署名のインストールパッケージとして、テストケースの `unsigned-sample-addon@clear-code.com.xpi` を用意し、
      `{{install_path}}\browser\extensions\unsigned-sample-addon@clear-code.com.xpi`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\browser\extensions\unsigned-sample-addon@clear-code.com.xpi`）{{/install_path_32bit}}
      の位置に置く。
    - Firefoxを起動する。
    - アドオンマネージャを開く。
    - **確認**
        - アドオン「Unsigned Sample Addon」が有効になっているか、または、無効の状態から有効化できる。
    - ポリシー設定から `BlockAboutAddons` を削除した場合、設定を元に戻す。

    :2: 禁止する（既定）

    - ポリシー設定から `BlockAboutAddons` を削除し、アドオンマネージャを一時的に有効化しておく。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - アドオンの未署名のインストールパッケージとして、テストケースの `unsigned-sample-addon@clear-code.com.xpi` を用意し、
      `{{install_path}}\browser\extensions\unsigned-sample-addon@clear-code.com.xpi`
      {{#install_path_32bit}}（32bit環境では `{{install_path_32bit}}\browser\extensions\unsigned-sample-addon@clear-code.com.xpi`）{{/install_path_32bit}}
      の位置に置く。
    - Firefoxを起動する。
    - アドオンマネージャを開く。
    - **確認**
        - アドオン「Unsigned Sample Addon」が無効になっており、有効化できない。
    - ポリシー設定から `BlockAboutAddons` を削除した場合、設定を元に戻す。

Admin-5: ポリシー設定の使用の可否

    :1: 使用する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
    - **確認**
        - ページ上部に「ご使用のブラウザーはあなたの所属組織に管理されています。」というメッセージが表示される。
    - `about:policies` を開く。
    - **確認**
        - 「エンタープライズポリシーサービスが有効です。」と表示される。

    :2: 使用しない

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
    - **確認**
        - ページ上部に「ご使用のブラウザーはあなたの所属組織に管理されています。」というメッセージが表示されない。



Security-1: 独自のルート証明書をあらかじめ導入しておく

    :2: 導入しない（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - `about:policies` を開く。
    - **確認**
        - 設定済みのポリシーの中に `Certificates` が含まれない。

    :3: Windowsの証明書データベースから自動的にインポートする

    - インポートされることが期待される認証局証明書がWindowsの証明書データベースに含まれる状態にする。
      例えば、テストケースの `add-badssl-com-enterprise-root.reg` を使用して「BadSSL.com」の認証局証明書をインポート済みの状態にする。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - インポートされる事が期待される認証局証明書に対応する認証局で発行された証明書を使用したWebサイトを開く。
      例えば、`https://untrusted-root.badssl.com/` を訪問する。
    - **確認**
        - 証明書のエラーが表示されず、Webサイトの内容をそのまま閲覧できる。
    - テストケースの `add-badssl-com-enterprise-root.reg` を使用した場合、テストケースの `remove-badssl-com-enterprise-root.reg` を使用して「BadSSL.com」の認証局証明書を削除する。

    :4: 導入する（ポリシーで設定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - `about:profiles` または `about:support` から、現在のユーザープロファイルフォルダを開く。
    - Firefoxを終了する。
    - ユーザープロファイルフォルダの内容をすべて削除する。
    - Firefoxを起動する。
    - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - 「証明書」セクションの「証明書を表示」ボタンをクリックして証明書マネージャーを開く。
    - 「認証局証明書」の一覧を表示する。
    - **確認**
        - インポートするよう指定した証明書が一覧に登録されている。

Security-3: アドオンのインストールの可否

    :1: 確認の上で許可する（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースリストの `{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi` リンクからファイルをダウンロードして、ブラウザウィンドウにドラッグ&ドロップする。
    - **確認**
        - アドオンをインストールできる。

    :3: 禁止する（ポリシー設定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースリストの `{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi` リンクからファイルをダウンロードして、ブラウザウィンドウにドラッグ&ドロップする。
    - **確認**
        - 「ソフトウェアのインストールはシステム管理者により無効化されています。」と表示され、アドオンをインストールできない。
    - ロケーションバーに`about:addons`と入力して確定する。
    - **確認**
        - `about:addons`への遷移がブロックされる。

    :4: 禁止するが、設定の変更は許可する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースリストの `{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi` リンクからファイルをダウンロードして、ブラウザウィンドウにドラッグ&ドロップする。
    - **確認**
        - 「ソフトウェアのインストールはシステム管理者により無効化されています。」と表示され、アドオンをインストールできない。
    - パネルメニューからアドオンマネージャを開く。
    - **確認**
        - 「アドオンを入手」が表示されない。
        - 歯車アイコンのメニュー内に「ファイルからアドオンをインストール」が含まれない。
        - 「拡張機能」タブが選択された状態で、アドオンマネージャ上にアドオンのインストールパッケージをドラッグ&ドロップして、アドオンがインストールされない。
        - 「アドオンを検索」欄に「Tab」と入力してEnterすると、「利用可能なアドオン」の検索結果が何も表示されない。

    :5: 特定サイトのみ初期状態で許可する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - アドオンのインストールを許可したサイトを開く。
    - ロケーションバー左端のアイコン部分をクリックする。
    - **確認**
        - 「サイト別設定」欄に、「アドオンのインストール」が「許可」と表示される。
    - 「アドオンのインストール」を「ブロック」に変更する。
    - Firefoxを終了し、再度起動する。
    - アドオンのインストールを許可したサイトを開く。
    - ロケーションバー左端のアイコン部分をクリックする。
    - **確認**
        - 「サイト別設定」欄に、「アドオンのインストール」が「ブロック」と表示される。

    :6: 特定サイトのみ常に許可する（ポリシーとして設定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - アドオンのインストールを許可したサイトを開く。
    - ロケーションバー左端のアイコン部分をクリックする。
    - **確認**
        - 「サイト別設定」欄に、「アドオンのインストール」が「許可」と表示される。
    - 「アドオンのインストール」を「ブロック」に変更する。
    - Firefoxを終了し、再度起動する。
    - アドオンのインストールを許可したサイトを開く。
    - ロケーションバー左端のアイコン部分をクリックする。
    - **確認**
        - 「サイト別設定」欄に、「アドオンのインストール」が「許可」と表示される。

    :7: 禁止するが、設定の変更は許可する（ポリシー設定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースリストの `{61FD08D8-A2CB-46c0-B36D-3F531AC53C12}.xpi` リンクからファイルをダウンロードして、ブラウザウィンドウにドラッグ&ドロップする。
    - **確認**
        - 「ソフトウェアのインストールはシステム管理者により無効化されています。」と表示され、アドオンをインストールできない。
    - パネルメニューからアドオンマネージャを開く。
    - **確認**
        - 「アドオンを入手」が表示されない。
        - 歯車アイコンのメニュー内に「ファイルからアドオンをインストール」が含まれない。
        - 「拡張機能」タブが選択された状態で、アドオンマネージャ上にアドオンのインストールパッケージをドラッグ&ドロップして、アドオンがインストールされない。
        - 「アドオンを検索」欄に「Tab」と入力してEnterすると、「利用可能なアドオン」の検索結果が何も表示されない。

Security-4: 広告などのポップアップの表示の可否

    :1: 確認の上で許可する（既定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースの `popupblock.html` を開く。
    - **確認**
        - ポップアップブロックの通知が表示される。

    :3: すべて確認無しで許可する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースの `popupblock.html` を開く。
    - **確認**
        - ポップアップブロックの通知が表示されずに、タブまたはウィンドウが開かれる。

    :4: 禁止する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースの `popupblock.html` を開く。
    - **確認**
        - ポップアップブロックの通知が表示される。
    - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「許可設定」配下の「ポップアップウィンドウをブロックする」の状態を変更できない。

    :5: 特定サイトのみ初期状態で確認無しで許可する

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースの `popupblock.html` を開く。
    - **確認**
        - ポップアップブロックの通知が表示される。
    - ポップアップが許可されたサイトを開き、ポップアップが開かれる操作を実施する。
    - **確認**
        - ポップアップブロックの通知が表示されずに、タブまたはウィンドウが開かれる。

    :6: 特定サイトのみ常に確認無しで許可する（ポリシーで設定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースの `popupblock.html` を開く。
    - **確認**
        - ポップアップブロックの通知が表示される。
    - ポップアップが許可されたサイトを開き、ポップアップが開かれる操作を実施する。
    - **確認**
        - ポップアップブロックの通知が表示されずに、タブまたはウィンドウが開かれる。

    :7: すべて確認無しで許可する（ポリシーで設定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースの `popupblock.html` を開く。
    - **確認**
        - ポップアップブロックの通知が表示されずに、タブまたはウィンドウが開かれる。

    :8: 禁止する（ポリシーで設定）

    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - テストケースの `popupblock.html` を開く。
    - **確認**
        - ポップアップブロックの通知が表示される。
    - パネルメニューを開き、パネルメニュー内の「オプション」をクリックする。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「許可設定」配下の「ポップアップウィンドウをブロックする」の状態を変更できない。

Security-5: 攻撃サイトに対する警告の可否

    :1: 警告する（既定）

    :2: 警告しない

Security-6: 偽装サイトに対する警告の可否

    :1: 警告する（既定）

    :2: 警告しない

Security-9: about:configの利用の可否

    :1: 許可する（既定）

    :3: 禁止する（ポリシーで設定）

Security-12: JavaScriptの実行の可否

    :1: 許可する（既定）

    :3: 禁止する

Security-13: ローカルファイルの読み込みの可否

    :1: 特定サイトのみ許可する

    :2: 禁止する（既定）

    :3: 特定サイトのみ許可する（ポリシーで設定）

Security-14: ローカルファイルからの他ディレクトリの参照の可否

    :1: 許可する

    :2: 禁止する（既定）

Security-15: その他、バックグラウンドで行われる外部への通信の可否

    :1: 許可する（既定）

    :2: 禁止する

Security-16: フルスクリーン表示の可否

    :1: 確認の上で許可する（既定）

    :3: 禁止する

Security-18: ツールバーカスタマイズにおける、「その他のテーマを入手」の遷移の可否

    :1: 許可する（既定）

    :2: 禁止する

Security-19: ツールバーカスタマイズにおける、テーマの「おすすめ」の取得の可否

    :1: 許可する（既定）

    :2: 禁止する

Security-21: 危険なアドオンとプラグインのブロックの可否

    :1: ブロックする（既定）

    :2: ブロックしない

Security-23: プラグインのサンドボックス内実行

    :1: サンドボックス内で実行しない（既定）

    :2: Flashプラグインのみサンドボックス内で実行

    :3: すべてサンドボックス内で実行

    :4: Flashプラグインのみより厳格なサンドボックス内で実行（Firefox 60既定値）

Security-24: Flashプラグインの保護モード

    :1: 使用する（既定）

    :2: 使用しない

Security-25: プロトコルごとの外部Webアプリケーションへの連携

    :1: 使用する（既定）

    :2: 使用しない

Security-26: ファイルのダウンロード保護により、危険なソフトウェアのインストールをブロックする

    :1: ブロックする（既定）

    :2: ブロックしない

Security-27: ファイルのダウンロード保護により、不要なソフトウェアのインストールの可能性がある場面で警告する

    :1: 警告する（既定）

    :2: 警告しない

Security-28: 認証が必要なWiFiアクセスポイントを検出した時に、認証用のタブを自動的に開く

    :1: タブを開く（既定）

    :2: 何もしない

    :3: 何もしない（ポリシーで設定）

Security-30: 誤ったMIME Typeが指定されたスクリプトファイルの実行

    :1: 許可する

    :2: 禁止する（既定）

Security-31: 危険なFlashコンテンツの読み込み

    :1: 許可する

    :2: ブロックする（既定）

Security-32: アドオンのインストール時の警告

    :1: 警告する（既定）

    :2: 警告しない

Security-33: 危険ででしゃばりなFlashコンテンツをブロック

    :1: ブロックする（既定）

    :2: ブロックしない

Security-34: about:profilesの使用

    :1: 許可する（既定）

    :2: 禁止する

Security-35: about:supportの使用

    :1: 許可する（既定）

    :2: 禁止する

Security-36: DNS over HTTPSの使用

    :1: 使用しない（既定）

    :2: 使用する（ポリシーで設定）

Security-37: セキュリティ警告の回避

    :1: 制限しない（既定）

    :2: 警告の回避を禁止する（ポリシーで設定）

Security-38: セキュリティデバイスの登録

    :1: 登録しない（既定）

    :2: 登録する（ポリシーで設定）

Security-39: 特定のWebサイトへのアクセスの遮断

    :1: 遮断しない（既定）

    :2: 遮断する（ポリシーで設定）

Security-40: アドオンのインストールを遮断した際の追加のメッセージ

    :1: 常に共通のメッセージを表示（既定）

    :2: アドオンごとにメッセージを指定（ポリシーで設定）

Security-41: 複数のポップアップを一度に開く操作

    :1: 許可する

    :2: 禁止する（既定）

Security-42: 過去にデータ流出事故を起こしたWebサービスでの警告の表示

    :1: 警告を表示する（既定）

    :2: 警告を表示しない

Security-43: ローカルファイルからの同じディレクトリのファイルの参照の可否

    :1: 許可する

    :2: 禁止する（既定）

Security-44: HTTPSでないURLのページでのカメラ・マイクの使用の可否

    :1: 許可する

    :2: 禁止する（既定）

Security-45: 証明書の例外の自動承認

    :1: 特定のホストの証明書の例外を自動的に承認する

