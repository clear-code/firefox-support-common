# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

External-1: ファイルをダウンロードして直接外部アプリケーションで開く時の挙動

    :1: ファイルを読み込み専用で開き、アプリケーション終了後に一時ファイルを削除する（既定）

    - エクスプローラを起動して、アドレスバーに `%temp%` と入力し、システムのテンポラリフォルダを開く。
    - ファイルを更新日時順で並べ替えて、新しいファイルが出現したら分かるようにしておく。
    - この検証手順書自体のファイルをWebサーバにアップロードするか、`odt sample` のようなキーワードでWebを検索するなどして、外部アプリケーションで開く必要があるファイルのダウンロード用リンクを用意しておく。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - 外部アプリケーションで開く必要があるファイルへのリンクをクリックする。
    - 「次のファイルを開こうとしています」のダイアログが表示されたら、起動する外部アプリケーションを選択して「OK」をクリックする。
    - テンポラリフォルダの内容を確認する。
    - **確認**
        - ダウンロードしたファイルがテンポラリフォルダに保存されている。
        - テンポラリファイルのプロパティにおいて、「読み取り専用」がチェックありもしくは半チェック（四角形の塗りつぶし、または半透明のチェックマーク）の状態である。
    - 外部アプリケーションを終了しFirefoxも終了して、テンポラリフォルダの内容を確認する。
    - **確認**
        - ダウンロードしたファイルがテンポラリフォルダから消えている。

    :2: ファイルを読み書き可能で開き、アプリケーション終了後に一時ファイルを削除しない

    - エクスプローラを起動して、アドレスバーに `%temp%` と入力し、システムのテンポラリフォルダを開く。
    - ファイルを更新日時順で並べ替えて、新しいファイルが出現したら分かるようにしておく。
    - この検証手順書自体のファイルをWebサーバにアップロードするか、`odt sample` のようなキーワードでWebを検索するなどして、外部アプリケーションで開く必要があるファイルのダウンロード用リンクを用意しておく。
    - `{{meta_installer_file_name}}*.exe` が作成済みの状態にする。
    - 検証用ユーザーとして `{{meta_installer_file_name}}*.exe` を実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - Firefoxを起動する。
    - 外部アプリケーションで開く必要があるファイルへのリンクをクリックする。
    - 「次のファイルを開こうとしています」のダイアログが表示されたら、起動する外部アプリケーションを選択して「OK」をクリックする。
    - テンポラリフォルダの内容を確認する。
    - **確認**
        - ダウンロードしたファイルがテンポラリフォルダに保存されている。
        - テンポラリファイルのプロパティにおいて、「読み取り専用」がチェック無しの状態である。
    - 外部アプリケーションを終了しFirefoxも終了して、テンポラリフォルダの内容を確認する。
    - **確認**
        - ダウンロードしたファイルがテンポラリフォルダに残っている。

