# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

Privacy-0: プライバシーの検証

   :1: 事前準備

    - 前項に引き続き検証するか、または以下の状態を整えておく。
        - 作成済みの `{{meta_installer_file_name}}*.exe` を検証用ユーザーとして実行し、カスタマイズ済みFirefoxのインストールを完了している。
          管理者権限を要求された場合は、`管理者`ユーザーで認証する。

Privacy-1: 履歴の保存の可否

    :2: 保存する（既定）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「履歴」で「Firefoxに履歴を記憶させる」が選択されているか、「記憶させる履歴を詳細設定」で「常にプライベートブラウジングモード」のチェックが外れていて選択不可になっているか項目自体が存在しない。
        - 「履歴」→「記憶させる履歴を詳細設定する」が選択されており、「Firefoxの終了時に履歴を消去する」の項目が存在しないか、チェックが外れていて選択不可になっている。

    :5: 履歴を基本的には保存し、ただし（一部項目は）終了時の消去を許可する / 起動時からのプライベートブラウジングの開始を無効

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「履歴」で「Firefoxに履歴を記憶させる」が選択されているか、「記憶させる履歴を詳細設定」で「常にプライベートブラウジングモード」のチェックが外れていて選択不可になっているか項目自体が存在しない。
        - （一部の履歴の削除を禁止する設定を導入した場合のみ）「Firefoxの終了時に履歴を消去する」の「設定」で、指定した項目にチェックが外れていて選択不可になっている。

    :7: 保存を強制する

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「履歴」で「Firefoxに履歴を記憶させる」が選択され変更不可になっているか、「記憶させる履歴を詳細設定」で「常にプライベートブラウジングモード」のチェックが外れていて変更不可になっているか項目自体が存在しない。
        - 「履歴」→「記憶させる履歴を詳細設定する」が選択されており、「Firefoxの終了時に履歴を消去する」の項目が存在しないか、チェックが外れていて選択不可になっている。

    :3: 一切保存しない

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「履歴」で「Firefoxに履歴を一切記憶させない」が選択されているか「記憶させる履歴を詳細設定」で「常にプライベートブラウジングモード」のチェックが入っていて選択不可になっている。
        - 「履歴」→「記憶させる履歴を詳細設定する」が選択されており、「Firefoxの終了時に履歴を消去する」の項目が存在しないか、チェックが外れていて選択不可になっている。

    :4: 終了時に消去する

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Firefoxの終了時に履歴を消去する」の「設定」で、指定した項目にチェックが入っていて選択不可になっている。

    :6: 終了時に消去する（ポリシーで設定）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Firefoxの終了時に履歴を消去する」の「設定」で、指定した項目にチェックが入っていて選択不可になっている。

Privacy-2: フォームの入力履歴の保存の可否（Webページ上のフォーム要素、およびWeb検索バーのオートコンプリート機能の無効化）

    :1: 保存する（既定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードを入力して送信する。
    - テストケースの `password.html` が再度読み込まれたら、ユーザーID欄をダブルクリックする。
    - **確認**
        - 入力履歴が表示される。

    :2: 保存しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードを入力して送信する。
    - テストケースの `password.html` が再度読み込まれたら、ユーザーID欄をダブルクリックする。
    - **確認**
        - 入力履歴が表示されない。

    :3: 保存しない（ポリシーで設定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードを入力して送信する。
    - テストケースの `password.html` が再度読み込まれたら、ユーザーID欄をダブルクリックする。
    - **確認**
        - 入力履歴が表示されない。

Privacy-3: ダウンロード履歴の保存の可否

    :1: 永続的に保存する（既定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ァイルに名前を付けて保存する。
    - Firefoxを再起動する。
    - 「履歴」→「すべての履歴を表示」を選択する。
    - **確認**
        - 「ダウンロード」の一覧に項目が存在する。

    :3: 保存しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ァイルに名前を付けて保存する。
    - Firefoxを再起動する。
    - 「履歴」→「すべての履歴を表示」を選択する。
    - **確認**
        - 「ダウンロード」の一覧に項目が存在しない。

Privacy-4: ロケーションバーの入力履歴の表示の可否

    :1: 表示する（既定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - Firefoxを再起動する。
    - ロケーションバーに `password.html` と入力する。
    - **確認**
        - ロケーションバーのオートコンプリートの項目として `password.html` の項目が表示される。

    :2: 表示しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - Firefoxを再起動する。
    - ロケーションバーに `password.html` と入力する。
    - **確認**
        - ロケーションバーのオートコンプリートの項目として `password.html` の項目が表示されない。

    :3: 表示しない（ポリシーで設定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - Firefoxを再起動する。
    - ロケーションバーに `password.html` と入力する。
    - **確認**
        - ロケーションバーのオートコンプリートの項目として `password.html` の項目が表示されない。

Privacy-5: パスワードの保存の可否

    :1: 確認の上で保存する（既定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードを入力して送信する。
    - **確認**
        - パスワードの保存を尋ねられる。
    - パスワードを保存する。
    - テストケースの `password.html` が再度読み込まれたら、パスワード欄をクリックする。
    - **確認**
        - 先ほど入力したパスワード情報が表示される。

    :2: 保存しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードを入力して送信する。
    - **確認**
        - パスワードの保存を尋ねられない。
    - テストケースの `password.html` が再度読み込まれたら、パスワード欄をクリックする。
    - **確認**
        - 先ほど入力したパスワード情報が表示されない。

    :4: 保存しない（ポリシーで設定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードを入力して送信する。
    - **確認**
        - パスワードの保存を尋ねられない。
    - テストケースの `password.html` が再度読み込まれたら、パスワード欄をクリックする。
    - **確認**
        - 先ほど入力したパスワード情報が表示されない。

    :3: 保存せず、マスターパスワードも使用しない（ポリシーで設定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードを入力して送信する。
    - **確認**
        - パスワードの保存を尋ねられない。
    - テストケースの `password.html` が再度読み込まれたら、パスワード欄をクリックする。
    - **確認**
        - 先ほど入力したパスワード情報が表示されない。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ログインとパスワード」配下の「マスターパスワードを使用する」にチェックが入っておらず、選択不可になっている。

Privacy-7: リンク先の先読みの可否

    :1: 許可する（既定）

    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューの「ウェブ開発」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - コンソール上の「要求」が選択された状態にする（すでに選択されていた場合は、一旦未選択状態に戻し、再度選択する）。
    - ブラウザウィンドウでテストケースリストのリンクから `https://www.clear-code.com/blog/2016/5/10.html` を開く。
    - **確認**
        - `GET https://www.clear-code.com/blog/2016/5/18.html` というログがコンソールに出力される。

    :2: 禁止する

    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューの「ウェブ開発」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - コンソール上の「要求」が選択された状態にする（すでに選択されていた場合は、一旦未選択状態に戻し、再度選択する）。
    - ブラウザウィンドウでテストケースリストのリンクから `https://www.clear-code.com/blog/2016/5/10.html` を開く。
    - **確認**
        - `GET https://www.clear-code.com/blog/2016/5/18.html` というログがコンソールに出力されない。

Privacy-8: 履歴の最低保証保持件数（lazyな最大保持件数）

    :1: 指定しない（既定）

    ABOUT_CONFIG

    - `places.history.expiration.max_pages` が未定義である。

    :2: 指定する

    ABOUT_CONFIG

    - `places.history.expiration.max_pages` の値が `{{history_expiration_max_pages}}` である。

Privacy-9: 日数ベースでの履歴の自動削除

    :1: 日数ベースで履歴を自動削除する

    - ポリシー設定から `BlockAboutAddons` を削除し、アドオンマネージャを一時的に有効化しておく。
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - 十分な日数分の履歴項目を以下の手順で用意する。
        - システムの日付と時刻について、インターネット経由での調整を無効にする。
          例えばWindowsであれば、タスクバーの時計を右クリックして「日付と時刻の調整」を選択し、「日付と時刻」ダイアログの「インターネット時刻」タブで「設定の変更」ボタンをクリックし、「インターネット時刻サーバーと同期する」のチェックを外す。（※要：管理者権限）
        -  システムの日付を(自動削除する日数＋2)日以上前の日付に変更する。
        - Firefox上で何らかのWebページを開き、リンクを辿ってページを遷移する。
        - この操作を、日付を1日ずつ進めながら繰り返す。
    - パネルメニューを開き、「アドオン」をクリックする。
    - アドオンマネージャ内の「拡張機能」をクリックする。
    - **確認**
        - 拡張機能の一覧に「Flexible Expire History by Days」が表示されており、有効になっている。
    - 「Flexible Expire History by Days」の設定画面を開く。
    - **確認**
        - 「Expire visits older than these days」の値が `(自動削除する日数)` である。
        - 「Frequency of expiration」で「On the first idle time per a day」が選択されている。
    - `about:config` を開く。
    - 「検索」欄に `idle.lastDailyNotification` と入力し、Enterを押す。
    - 項目が見つかった場合、項目を右クリックしてメニューから「リセット」を選択する。
    - Firefoxを再起動する。
    - メニューバーの「履歴」から「すべての履歴」を選択し、「履歴とブックマークの管理」ウィンドウを開く（すべての履歴項目を表示した状態にする）。
    - 「履歴」配下の「7日以内」、「（前月）月」、または指定の履歴保存期間のしきい値となる日付が含まれる期間を選択する。
    - 履歴一覧のカラム列を右クリックし、「最近表示した日時」にチェックを入れる。
    - **確認**
        - 当日までの日付の履歴項目が並んでいる。
    - マウスとキーボードから手を離し、4分以上、何も操作せずに放置する。
    - **確認**
        - 前日を含めて過去5日間の履歴が残っており、それよりも古い履歴項目が残っていない。

Privacy-11: Cookie、IndexedDB、Web Storage、およびService Worker用Cacheの保存の可否

    :1: 永続的に許可する（既定）

    - Firefoxを起動する。
    - `about:policies` を開く。
    - **確認**
        - `Cookies` の `Default` の値が `true` である。

    :6: 既定では禁止し、特定サイトのみ永続的に許可する（ポリシーで設定）

    - Firefoxを起動する。
    - `about:policies` を開く。
    - **確認**
        - `Cookies` の `Default` の値が `false` である。
        - `Cookies` の `Allow` の値として許可サイトが列挙されている。

    :3: セッション中のみ許可する（ポリシーで設定）

    - Firefoxを起動する。
    - `about:policies` を開く。
    - **確認**
        - `Cookies` の `ExpireAtSessionEnd` の値が `true` である。

    :4: 禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - `about:policies` を開く。
    - **確認**
        - `Cookies` の `Default` の値が `false` である。

    :7: 既定では永続的に許可し、特定サイトのみ禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - `about:policies` を開く。
    - **確認**
        - `Cookies` の `Default` の値が `true` である。
        - `Cookies` の `Allow` の値として禁止サイトが列挙されている。

Privacy-12: DOMストレージの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「localStorage」欄に `enabled` と出力される。

    :2: 禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「localStorage」欄に `disabled` と出力される。

Privacy-13: Indexed DBの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「indexedDB」欄に `enabled` と出力される。

    :3: 禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「indexedDB」欄に `disabled` と出力される。

Privacy-14: 位置情報の利用の可否

    :1: 確認の上で許可する（既定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると「このサイトに位置情報の共有を許可しますか？」と尋ねられる。

    :6: すべてのサイトについて初期状態で確認無しで禁止する（「位置情報へのアクセスの要求をブロック」にチェック）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると「fail: cannot fetch your location」というエラーが表示される。
    - 確認無しでの位置情報の取得を許可するサイトが定義されている場合、以下の検証も行う。
        - 許可サイトを開き、ロケーションバー左端のアイコン部分をクリックする。
            - **確認**
                - 「サイト別設定」欄に、「位置情報の送信」が「ブロック」と表示される。
        - 「位置情報の送信」で「許可」を選択する。
        - Firefoxを再起動する
        - そのページを開き、ロケーションバー左端のアイコン部分をクリックする。
            - **確認**
                - 「サイト別設定」欄に、「位置情報の送信」が「許可」と表示される。

    :7: すべてのサイトについて初期状態で確認無しで許可する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると確認なしで取得された座標が表示される。

    :4: 特定サイトのみ初期状態で確認なしで許可/禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると「このサイトに位置情報の共有を許可しますか？」と尋ねられる。
    - 確認無しでの位置情報の取得を許可するサイトが定義されている場合、以下の検証も行う。
        - 許可サイトを開き、ロケーションバー左端のアイコン部分をクリックする。
            - **確認**
                - 「サイト別設定」欄に、「位置情報の送信」が「許可」と表示される。
        - 「位置情報の送信」で「ブロック」を選択する。
        - Firefoxを再起動する
        - そのページを開き、ロケーションバー左端のアイコン部分をクリックする。
            - **確認**
                - 「サイト別設定」欄に、「位置情報の送信」が「ブロック」と表示される。

    :5: 特定サイトのみ初期状態で確認なしで許可/禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると「このサイトに位置情報の共有を許可しますか？」と尋ねられる。
    - 確認無しでの位置情報の取得を許可するサイトが定義されている場合、以下の検証も行う。
        - 許可サイトを開き、ロケーションバー左端のアイコン部分をクリックする。
            - **確認**
                - 「サイト別設定」欄に、「位置情報の送信」が「許可」と表示される。
        - 「位置情報の送信」で「ブロック」を選択する。
        - Firefoxを再起動する
        - そのページを開き、ロケーションバー左端のアイコン部分をクリックする。
            - **確認**
                - 「サイト別設定」欄に、「位置情報の送信」が「ブロック」と表示される。

    :3: 禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `disabled` と出力される。

Privacy-15: 検索結果のローカライズ用地域コードの位置情報に基づく推定の可否

    :1: 許可する（既定）

    ABOUT_CONFIG

    - `browser.search.geoip.url` の値が未定義や空でない。

    :2: 禁止する

    ABOUT_CONFIG

    - `browser.search.geoip.url` の値が空文字である。

Privacy-16: DNSの先読みの可否

    :1: 許可する（既定）

    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `network.dns.notifyResolution`（真偽型）：`true`
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューで「ウェブ開発」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - 以下のコードをコンソール内で実行する。
        - `Services.obs.addObserver({observe:(s,t,d)=>console.log(t+': '+d)},'dns-resolution-request',false);`
    - コンソール上の「要求」が選択された状態にする（すでに選択されていた場合は、一旦未選択状態に戻し、再度選択する）。
    - ブラウザウィンドウでテストケースの `prefetching.html` を開く。
    - **確認**
        - `dns-resolution-request: dns-prefetch.example.com` というログがブラウザーコンソールに出力される。

    :2: 禁止する

    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `network.dns.notifyResolution`（真偽型）：`true`
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューで「ウェブ開発」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - 以下のコードをコンソール内で実行する。
        - `Services.obs.addObserver({observe:(s,t,d)=>console.log(t+': '+d)},'dns-resolution-request',false);`
    - コンソール上の「要求」が選択された状態にする（すでに選択されていた場合は、一旦未選択状態に戻し、再度選択する）。
    - ブラウザウィンドウでテストケースの `prefetching.html` を開く。
    - **確認**
        - `dns-resolution-request: dns-prefetch.example.com` というログがブラウザーコンソールに出力されない。

Privacy-17: 検索エンジンの候補表示（Suggest）の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - ツールバー上のロケーションバーまたは検索窓にフォーカスし `a` と入力する。
    - **確認**
        - `a` の補完候補が表示される。
    - ツールバー上のロケーションバーにフォーカスし「新しい検索語句」等、履歴やブックマーク等からの候補が表示され得ないテキストを入力する。
    - **確認**
        - 補完候補が表示される。
    - 設定画面の「検索」タブから「既定の検索エンジン」欄を確認する。
    - **確認**
        - 「検索候補を使用する」にチェックが入っていて選択不可になっている。
        - 「アドレスバーに検索候補を表示する」にチェックが入っていて選択不可になっている。

    :2: 禁止する

    - Firefoxを起動する。
    - ツールバー上のロケーションバーまたは検索窓にフォーカスし `a` と入力する。
    - **確認**
        - `a` の補完候補が表示されない。
    - ツールバー上のロケーションバーにフォーカスし「新しい検索語句」等、履歴やブックマーク等からの候補が表示され得ないテキストを入力する。
    - **確認**
        - 補完候補が表示されない。
    - 設定画面の「検索」タブから「既定の検索エンジン」欄を確認する。
    - **確認**
        - 「検索候補を使用する」のチェックが外れていて選択不可になっている。
        - 「アドレスバーに検索候補を表示する」のチェックが外れていて選択不可になっている。

    :3: 禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - ツールバー上のロケーションバーまたは検索窓にフォーカスし `a` と入力する。
    - **確認**
        - `a` の補完候補が表示されない。
    - ツールバー上のロケーションバーにフォーカスし「新しい検索語句」等、履歴やブックマーク等からの候補が表示され得ないテキストを入力する。
    - **確認**
        - 補完候補が表示されない。
    - 設定画面の「検索」タブから「既定の検索エンジン」欄を確認する。
    - **確認**
        - 「検索候補を使用する」のチェックが外れていて選択不可になっている。
        - 「アドレスバーに検索候補を表示する」のチェックが外れていて選択不可になっている。

Privacy-18: 利用状況の統計の保存および送信の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Firefoxが技術的な対話データをMozillaへ送信することを許可する」にチェックが入っている。

    :2: 禁止する

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Firefoxが技術的な対話データをMozillaへ送信することを許可する」のチェックが外れている。

    :3: 禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Firefoxが技術的な対話データをMozillaへ送信することを許可する」のチェックが外れている。

Privacy-19: セキュリティエラーレポートの送信の可否

    :1: 許可する（既定）

    ABOUT_CONFIG

    - `security.ssl.errorReporting.automatic` の値が `true` である。
    - `security.ssl.errorReporting.enabled` の値が `true` である。
    - `security.ssl.errorReporting.url` の値が空文字でない。

    :2: 禁止する

    ABOUT_CONFIG

    - `security.ssl.errorReporting.automatic` の値が `false` である。
    - `security.ssl.errorReporting.enabled` の値が `false` である。
    - `security.ssl.errorReporting.url` の値が空文字である。

Privacy-21: クラッシュレポートの送信の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Firefoxに、あなたに代わって未送信のクラッシュレポートを送信するのを許可する」にチェックが入っている。

    :2: 禁止する

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Firefoxに、あなたに代わって未送信のクラッシュレポートを送信するのを許可する」のチェックが外れている。

    :3: レジストリでグローバルに禁止する

    - Windowsキーを押しながら「R」を押し、「ファイル名を指定して実行」ダイアログを開く。
    - `regedit.exe` と入力し、実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - `HKEY_LOCAL_MACHINE\SOFTWARE\Mozilla\Firefox\Crash Reporter`
      （32bit版Firefoxを64bit環境で使用している場合は `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Mozilla\Firefox\Crash Reporter`）
      を開く。
    - **確認**
        - 値 `SubmitCrashReport` のデータが `0` である。
        - 値 `Enabled` のデータが `0` である。

Privacy-22: Firefox Syncの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在する。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在する。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Sync」が存在する。
        - 「Syncにサインイン」が存在する。

    :2: 禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在しない。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在しない。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Sync」が存在しない。
        - 「Syncにサインイン」が存在しない。

    :3: 禁止する

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在しない。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在しない。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Sync」が存在しない。
        - 「Syncにサインイン」が存在しない。

Privacy-24: Firefoxアカウントの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在する。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在する。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Sync」が存在する。
        - 「Syncにサインイン」が存在する。

    :2: 禁止する

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在しない。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在しない。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Sync」が存在しない。
        - 「Syncにサインイン」が存在しない。

    :3: 禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在しない。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「Syncにログイン」の項目が存在しない。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Sync」が存在しない。
        - 「Syncにサインイン」が存在しない。

Privacy-26: 「忘れる」ボタンの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「忘れる」が存在する。

    :2: 禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「忘れる」が存在しない。

Privacy-27: Pocket（リーディングリスト機能）の利用の可否

    :1: 許可する

    - Firefoxを起動する。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Pocket」が存在する。
    - Webページ中の任意のリンクを右クリックしてコンテキストメニューを開く。
    - **確認**
        - 「リンクをPocketに保存」が存在する。

    :2: 禁止する

    - Firefoxを起動する。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Pocket」が存在しない。
    - Webページ中の任意のリンクを右クリックしてコンテキストメニューを開く。
    - **確認**
        - 「リンクをPocketに保存」が存在しない。

    :3: 禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - パネルメニュー内の「カスタマイズ」をクリックしてツールバーのカスタマイズ画面を開く。
    - **確認**
        - 「Pocket」が存在しない。
    - Webページ中の任意のリンクを右クリックしてコンテキストメニューを開く。
    - **確認**
        - 「リンクをPocketに保存」が存在しない。

Privacy-29: 履歴・ブックマーク用データベースの自動最適化

    :1: 1週間に1回、最低限の最適化のみ行う（既定）

    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を新規に作成する（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `idle.lastDailyNotification`（整数型）：`0`
        - `places.database.lastMaintenance`（整数型）：`0`
    - Firefoxを再起動する。
    - パネルメニューの「ウェブ開発」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - キーボード、マウスから手を離し、4分以上待つ。
    - **確認**
        - ブラウザーコンソールに以下のメッセージが1つも表示されない。
            - `PlacesDBUtils.maintenanceOnIdle() is called and redirected to checkAndFixDatabase().`
            - `PlacesDBUtils.checkAndFixDatabase() successfully finished.`
            - `The database has been vacuumed.`

    :2: 1週間に1回、VACUUMも含めて行う

    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を新規に作成する（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `idle.lastDailyNotification`（整数型）：`0`
        - `places.database.lastMaintenance`（整数型）：`0`
    - Firefoxを再起動する。
    - パネルメニューの「ウェブ開発」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - キーボード、マウスから手を離し、4分以上待つ。
    - **確認**
        - ブラウザーコンソールに以下のメッセージがすべて出力される。
            - `PlacesDBUtils.maintenanceOnIdle() is called and redirected to checkAndFixDatabase().`
            - `PlacesDBUtils.checkAndFixDatabase() successfully finished.`
            - `The database has been vacuumed.`

Privacy-30: ディスクキャッシュの最大サイズ制限

    :1: 制限しない（既定）

    - Firefoxを起動する。
    - `about:cache` を開く。
    - **確認**
        - 「disk」欄の「Maximum storage size」の値が `1048576` などの自動算出された値になっている。

    :2: 制限する

    - Firefoxを起動する。
    - `about:cache` を開く。
    - **確認**
        - 「disk」欄の「Maximum storage size」の値が指定値と一致している。

    :3: ディスクキャッシュを使用しない

    - Firefoxを起動する。
    - `about:cache` を開く。
    - **確認**
        - 「disk」欄の「Storage disk location」に「none, only stored in memory」と表示されている。
    - `{{special_profile_path}}\{{special_profile_name}}\cache2` 、もしくは `%LocalAppData%\Mozilla\Firefox\Profiles\（ランダムな文字列）.default\cache2` を開き、その中の `entries` フォルダを開く。
    - **確認**
        - フォルダが空である。

Privacy-32: リンクのhoverによるリンク先の先読みの可否

    :1: 許可する（既定）

    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - MCD設定ファイルに以下の設定を追加しておく。
        - `lockPref("logging.nsHttp", 5);`
        - `lockPref("logging.NetworkPredictor", 5);`
        - `lockPref("logging.config.sync", true);`
        - `lockPref("logging.config.add_timestamp", true);`
        - `lockPref("logging.config.LOG_FILE","C:\\Users\\Public\\http.log");`
    - `C:\Users\Public\http.log-*` を全て削除しておく。
    - 先読み対象となるページのホスト名がプライベートIPアドレスに解決される環境においては、先読み機能が作用せず実際の動作での検証が不可能なため、グローバルIPアドレスでWebサイトに接続可能な状態にしておく。
      もしくは、本節での先読みに関する検証を省略する。
    - Firefoxを起動する。
    - `about:config` を開く。
    - **確認**
        - 先読み対象となるページのホスト名がプライベートIPアドレスに解決される環境で、`network.http.speculative-parallel-limit` が `1` またはそれ以上である。
    - `C:\Users\Public\http.log` の位置に出力されているログファイル（複数ある場合はサイズが最も大きい物）をブラウザで開き、テストケースの`httplog.html`所定のスクリプトを実行する。
    - **確認**
        - 「All skipped? false」とコンソールに出力される。

    :2: 禁止する

    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - MCD設定ファイルに以下の設定を追加しておく。
        - `lockPref("logging.nsHttp", 5);`
        - `lockPref("logging.NetworkPredictor", 5);`
        - `lockPref("logging.config.sync", true);`
        - `lockPref("logging.config.add_timestamp", true);`
        - `lockPref("logging.config.LOG_FILE","C:\\Users\\Public\\http.log");`
    - `C:\Users\Public\http.log-*` を全て削除しておく。
    - 先読み対象となるページのホスト名がプライベートIPアドレスに解決される環境においては、先読み機能が作用せず実際の動作での検証が不可能なため、グローバルIPアドレスでWebサイトに接続可能な状態にしておく。
      もしくは、本節での先読みに関する検証を省略する。
    - Firefoxを起動する。
    - `about:config` を開く。
    - **確認**
        - 先読み対象となるページのホスト名がプライベートIPアドレスに解決される環境で、`network.http.speculative-parallel-limit` が `0` である。
    - `C:\Users\Public\http.log` の位置に出力されているログファイル（複数ある場合はサイズが最も大きい物）をブラウザで開き、テストケースの`httplog.html`所定のスクリプトを実行する。
    - **確認**
        - 「All skipped? true」とコンソールに出力される。

Privacy-33: Webサービスによる行動履歴の収集（トラッキング）の遮断の可否

    :1: ブロックリストを取得して、プライベートブラウジング時のみトラッキングを遮断する（既定）

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `false` である。
    - `privacy.trackingprotection.pbmode.enabled` が `true` である。

    :2: ブロックリストを取得して、トラッキングを常に遮断する

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `true` である。
    - `privacy.trackingprotection.pbmode.enabled` が `true` である。

    :4: ブロックリストを取得して、トラッキングを常に遮断する（ポリシー設定を併用）

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `true` である。
    - `privacy.trackingprotection.pbmode.enabled` が `true` である。

    :3: ブロックリストを取得せず、トラッキングを遮断しない

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `false` である。
    - `privacy.trackingprotection.pbmode.enabled` が `false` である。

    :5: ブロックリストを取得せず、トラッキングを遮断しない（ポリシーで設定）

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `false` である。
    - `privacy.trackingprotection.pbmode.enabled` が `false` である。

Privacy-34: フォームへのユーザー入力値のセッション情報への保存の可否

    :1: 許可する（既定）

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル  
      `{{special_profile_path}}` {%if special_profile_actual_path %}  
      （{{special_profile_actual_path}}）{% endif %}  
      を削除する。
    - テストケースの `password.html` を開く。
    - ユーザID欄に「ユーザ入力値」と入力し、20秒待つ。
    - ユーザープロファイル内の `sessionstore-backups` フォルダ内の `recovery.jsonlz4` の内容を確認する。
      例えば、ファイルをLinux環境にコピーして、 `sudo npm install -g mozlz4a` で必要なコマンドをインストールした後、`mozlz4a-decompress recovery.jsonlz4  | jq . | grep "ユーザ入力値"` を実行して、行が見つかるかどうかを調べる。
    - **確認**
        - ファイル内に「ユーザ入力値」という文字列が含まれている。

    :2: 一切禁止する

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル  
      `{{special_profile_path}}` {%if special_profile_actual_path %}  
      （{{special_profile_actual_path}}）{% endif %}  
      を削除する。
    - テストケースの `password.html` を開く。
    - ユーザID欄に「ユーザ入力値」と入力し、20秒待つ。
    - ユーザープロファイル内の `sessionstore-backups` フォルダ内の `recovery.jsonlz4` の内容を確認する。
      例えば、ファイルをLinux環境にコピーして、 `sudo npm install -g mozlz4a` で必要なコマンドをインストールした後、`mozlz4a-decompress recovery.jsonlz4  | jq . | grep "ユーザ入力値"` を実行して、行が見つかるかどうかを調べる。
    - **確認**
        - ファイル内に「ユーザ入力値」という文字列が含まれていない。

Privacy-35: トラッキングの遮断に使用するブロックリストの指定

    :1: レベル1（基本）ブロックを初期設定とし、変更を許可（既定）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ブロックリストを変更」リンクで開かれるブロックリストの選択で、「レベル1ブロックリスト」が選択されている。

    :2: レベル2（厳格）ブロックを初期設定とし、変更を許可

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ブロックリストを変更」リンクで開かれるブロックリストの選択で、「レベル2ブロックリスト」が選択されている。

    :3: レベル1（基本）ブロックで固定

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ブロックリストを変更」リンクで開かれるブロックリストの選択で、「レベル1ブロックリスト」が選択されている。

    :4: レベル2（厳格）ブロックで固定

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ブロックリストを変更」リンクで開かれるブロックリストの選択で、「レベル2ブロックリスト」が選択されている。

Privacy-36: TLS/SSLで保護された通信のコンテンツのディスク上へのキャッシュ

    :1: 許可する（既定）

    - Firefoxを起動する。
    - テンポラリファイルおよびキャッシュファイルフォルダ内の `thumbnails` フォルダを開く。
    - テストケースリストのリンクから開いた `https://addons.mozilla.org/` サイト内のリンクを何度か遷移する。
    - **確認**
        - サムネイル画像が保存される。

    :2: 禁止する

    - Firefoxを起動する。
    - テンポラリファイルおよびキャッシュファイルフォルダ内の `thumbnails` フォルダを開く。
    - テストケースリストのリンクから開いた `https://addons.mozilla.org/` サイト内のリンクを何度か遷移する。
    - **確認**
        - サムネイル画像が保存されない。

Privacy-37: ネットワーク経由での先読み機能の全般的な制御

    :1: 先読みを許可する（既定）

    - 先読み対象となるページのホスト名がグローバルIPアドレスに解決される環境では、以下の手順を実施する。
        - MCD設定ファイルに以下の設定を追加しておく。
            - `lockPref("logging.nsHttp", 5);`
            - `lockPref("logging.NetworkPredictor", 5);`
            - `lockPref("logging.config.sync", true);`
            - `lockPref("logging.config.add_timestamp", true);`
            - `lockPref("logging.config.LOG_FILE","C:\\Users\\Public\\http.log");`
        - `C:\Users\Public\http.log-*` を全て削除しておく。
        - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
        - Firefoxを起動する。
        - `https://www.clear-code.com/blog/` を開く。
        - 記事の個別ページを10ページほど訪問する。
        - Firefoxを終了する。
        - MCD設定ファイルに追加した設定を削除または無効化する。
        - Firefoxを起動する。
        - テストケースの `httplog.html` を開き、スクリプトをコピーする。
        - `C:\Users\Public\http.log` の位置に出力されているログファイル（複数ある場合はサイズが最も大きい物）をFirefoxで開く。
        - 「Ctrl-Shift-K」でコンソールを開く。
        - コピーしたスクリプトを貼り付けて、実行する。
        - **確認**
            - コンソールに「All cancelled? false」と出力される。
    - 先読み対象となるページのホスト名がプライベートIPアドレスに解決される環境では、以下の手順を実施する。
        - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
        - Firefoxを起動する。
        - `about:config` を開く。
        - **確認**
            - `network.predictor.enabled` の値が `true` である。

    :2: 先読みを禁止する

    - 先読み対象となるページのホスト名がグローバルIPアドレスに解決される環境では、以下の手順を実施する。
        - MCD設定ファイルに以下の設定を追加しておく。
            - `lockPref("logging.nsHttp", 5);`
            - `lockPref("logging.NetworkPredictor", 5);`
            - `lockPref("logging.config.sync", true);`
            - `lockPref("logging.config.add_timestamp", true);`
            - `lockPref("logging.config.LOG_FILE","C:\\Users\\Public\\http.log");`
        - `C:\Users\Public\http.log-*` を全て削除しておく。
        - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
        - Firefoxを起動する。
        - `https://www.clear-code.com/blog/` を開く。
        - 記事の個別ページを10ページほど訪問する。
        - Firefoxを終了する。
        - MCD設定ファイルに追加した設定を削除または無効化する。
        - Firefoxを起動する。
        - テストケースの `httplog.html` を開き、スクリプトをコピーする。
        - `C:\Users\Public\http.log` の位置に出力されているログファイル（複数ある場合はサイズが最も大きい物）をFirefoxで開く。
        - 「Ctrl-Shift-K」でコンソールを開く。
        - コピーしたスクリプトを貼り付けて、実行する。
        - **確認**
            - コンソールに「All cancelled? true」と出力される。
    - 先読み対象となるページのホスト名がプライベートIPアドレスに解決される環境では、以下の手順を実施する。
        - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
        - Firefoxを起動する。
        - `about:config` を開く。
        - **確認**
            - `network.predictor.enabled` の値が `false` である。

Privacy-38: Webビーコンの送信

    :1: 許可する（既定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「beacon」欄に `enabled` と表示される。

    :2: 禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「beacon」欄に `disabled` と表示される。

Privacy-39: SSL/TLSでないページへのパスワード入力時の警告

    :1: 警告する（既定）

    - Firefoxを起動する。
    - テストケースの `insecure-password.html` を開く。
    - パスワードの入力欄にフォーカスを移す。
    - **確認**
        - 安全でないフォームである旨の警告のメッセージが表示される。

    :2: 警告しない

    - Firefoxを起動する。
    - テストケースの `insecure-password.html` を開く。
    - パスワードの入力欄にフォーカスを移す。
    - **確認**
        - 安全でないフォームである旨の警告のメッセージが表示されない。

Privacy-40: パスワード保存ポップアップにおける、パスワードを平文表示するチェックボックスの表示の可否

    :1: 表示する（既定）

    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - `about:config` を開く。
    - **確認**
        - `signon.rememberSignons.visibilityToggle` の値が `true` である。
    - テストケースの `password.html` を開く。
    - ユーザID、パスワードを入力して送信する。
    - **確認**
        - パスワードの保存を提案するポップアップが表示され、その中に「パスワードを開示」チェックボックスが表示される。

    :2: 表示しない

    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - `about:config` を開く。
    - **確認**
        - `signon.rememberSignons.visibilityToggle` の値が `false` である。
    - テストケースの `password.html` を開く。
    - ユーザID、パスワードを入力して送信する。
    - **確認**
        - パスワードの保存を提案するポップアップが表示され、その中に「パスワードを開示」チェックボックスが表示されない。

Privacy-41: トラッキング保護機能の通知メッセージの表示

    :1: 20回まで表示する（既定）

    - Firefoxを起動する。
    - ストケースリストのリンクから `http://www.kantei.go.jp/` を開く。
        - トラッキング保護機能が働いた旨の通知ポップアップが表示される。

    :2: 表示しない

    - Firefoxを起動する。
    - ストケースリストのリンクから `http://www.kantei.go.jp/` を開く。
        - トラッキング保護機能が働いた旨の通知ポップアップが表示されない。

Privacy-42: Firefoxの新機能のテストへの参加の可否

    :1: 参加する

    - Firefoxを起動する。
    - `about:policies` を開く。
    - 「有効」配下の各設定値を確認する。
    - **確認**
        - `DisableFirefoxStudies` の値が `false` である。

    :2: 参加しない

    - Firefoxを起動する。
    - `about:policies` を開く。
    - 「有効」配下の各設定値を確認する。
    - **確認**
        - `DisableFirefoxStudies` の値が `true` である。

Privacy-43: 「Do Not Track」ヘッダの送出の可否

    :1: トラッキング防止の使用時のみ(既定)

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ウェブサイトに"Do Not Track"信号を送り、追跡されたくないことを知らせます」の項目で「常に送る」が選択されていない。

    :2: 常に送る

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ウェブサイトに"Do Not Track"信号を送り、追跡されたくないことを知らせます」の項目で「常に送る」が選択されている。

    :3: プライベートウィンドウのみ送出

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ウェブサイトに"Do Not Track"信号を送り、追跡されたくないことを知らせます」の項目で「常に送る」が選択されていない。

    :4: 送出しない

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ウェブサイトに"Do Not Track"信号を送り、追跡されたくないことを知らせます」の項目で「常に送る」が選択されていない。

Privacy-44: 通常モードでのリファラの通知ポリシー

    :1: 一切通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy` の値が `0` である。

    :2: オリジンが同じである場合はパスまで含むURLを通知・それ以外は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy` の値が `1` である。

    :3: オリジンが同じである場合はパスまで含むURLを通知・オリジンが異なる場合はオリジンまでを通知・セキュリティレベルが異なる場合は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy` の値が `2` である。

    :4: セキュリティレベルが同じである場合はオリジンの違いに関わらずパスまで含むURLを通知・セキュリティレベルが異なる場合は通知しない（既定）

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy` の値が `3` である。

Privacy-45: プライベートブラウジングモードでのリファラの通知ポリシー

    :1: 一切通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.pbmode` の値が `0` である。

    :2: オリジンが同じである場合はパスまで含むURLを通知・それ以外は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.pbmode` の値が `1` である。

    :3: オリジンが同じである場合はパスまで含むURLを通知・オリジンが異なる場合はオリジンまでを通知・セキュリティレベルが異なる場合は通知しない（既定）

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.pbmode` の値が `2` である。

    :4: セキュリティレベルが同じである場合はオリジンの違いに関わらずパスまで含むURLを通知・セキュリティレベルが異なる場合は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.pbmode` の値が `3` である。

Privacy-46: カメラの利用の可否

    :1: 確認の上で許可する（既定）

    ABOUT_CONFIG

    - `permissions.default.camera` の値が `0` である。

    :2: 特定サイトのみ初期状態で確認なしで許可/禁止する

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - 「許可設定」→「カメラ」→「設定」を開く。
    - **確認**
        - `default.permissions` で `1` を設定したサイトが許可サイトとして、`2` を設定したサイトが禁止サイトとして表示される。

    :5: 特定サイトのみ初期状態で確認なしで許可/禁止する（ポリシーで設定）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - 「許可設定」→「カメラ」→「設定」を開く。
    - **確認**
        - `default.permissions` で `1` を設定したサイトが許可サイトとして、`2` を設定したサイトが禁止サイトとして表示される。

    :3: すべてのサイトについて初期状態で確認無しで許可する

    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - 「許可設定」→「カメラ」→「設定」を開く。
    - **確認**
        - 「カメラへのアクセスの要求をブロック」がチェックされていない。
    - `about:config` を開く。
    - **確認**
        - `permissions.default.camera` の値が `1` である。

    :4: すべてのサイトについて初期状態で確認無しで禁止する（「カメラへのアクセスの要求をブロック」にチェック）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - 「許可設定」→「カメラ」→「設定」を開く。
    - **確認**
        - 「カメラへのアクセスの要求をブロック」がチェック済みである。

Privacy-47: マイクの利用の可否

    :1: 確認の上で許可する（既定）

    ABOUT_CONFIG

    - `permissions.default.microphone` の値が `0` である。

    :2: 特定サイトのみ初期状態で確認なしで許可/禁止する

    ABOUT_CONFIG

    - `permissions.default.microphone` の値が `0` である。

    :5: 特定サイトのみ初期状態で確認なしで許可/禁止する（ポリシーで設定）

    ABOUT_CONFIG

    - `permissions.default.microphone` の値が `0` である。

    :3: すべてのサイトについて初期状態で確認無しで許可する

    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - 「許可設定」→「マイク」→「設定」を開く。
    - **確認**
        - 「マイクへのアクセスの要求をブロック」がチェックされていない。
    - `about:config` を開く。
    - **確認**
        - `permissions.default.microphone` の値が `1` である。

    :4: すべてのサイトについて初期状態で確認無しで禁止する（「マイクへのアクセスの要求をブロック」にチェック）

    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - 「許可設定」→「マイク」→「設定」を開く。
    - **確認**
        - 「マイクへのアクセスの要求をブロック」がチェック済みである。
    - `about:config` を開く。
    - **確認**
        - `permissions.default.microphone` の値が `4` である。

Privacy-48: リファラの通知の有無

    :1: リンクの遷移、埋め込み画像の取得時に通知（既定）

    ABOUT_CONFIG

    - `network.http.sendRefererHeader` の値が `2` である。

    :2: リンクの遷移時にのみ通知

    ABOUT_CONFIG

    - `network.http.sendRefererHeader` の値が `1` である。

    :3: 一切通知しない

    ABOUT_CONFIG

    - `network.http.sendRefererHeader` の値が `0` である。

Privacy-49: 通常モードでの行動履歴のトラッキングに対するリファラの通知ポリシー

    :1: 一切通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers` の値が `0` である。

    :2: オリジンが同じである場合はパスまで含むURLを通知・それ以外は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers` の値が `1` である。

    :3: オリジンが同じである場合はパスまで含むURLを通知・オリジンが異なる場合はオリジンまでを通知・セキュリティレベルが異なる場合は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers` の値が `2` である。

    :4: セキュリティレベルが同じである場合はオリジンの違いに関わらずパスまで含むURLを通知・セキュリティレベルが異なる場合は通知しない（既定）

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers` の値が `3` である。

Privacy-50: プライベートブラウジングモードでの行動履歴のトラッキングに対するリファラの通知ポリシー

    :1: 一切通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers.pbmode` の値が `0` である。

    :2: オリジンが同じである場合はパスまで含むURLを通知・それ以外は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers.pbmode` の値が `1` である。

    :3: オリジンが同じである場合はパスまで含むURLを通知・オリジンが異なる場合はオリジンまでを通知・セキュリティレベルが異なる場合は通知しない（既定）

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers.pbmode` の値が `2` である。

    :4: セキュリティレベルが同じである場合はオリジンの違いに関わらずパスまで含むURLを通知・セキュリティレベルが異なる場合は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers.pbmode` の値が `3` である。

Privacy-51: プライベートウィンドウでのアドオンの動作可否

    :1: 原則として禁止し、個別に許可する（既定）

    - ポリシー設定から `DisablePrivateBrowsing` の設定を削除し、プライベートウィンドウ機能を一時的に有効化しておく。
    - ポリシー設定から `BlockAboutAddons` の設定を削除し、アドオンマネージャを一時的に有効化しておく。
    - Firefoxを起動する。
    - アドオンマネージャを開く。
    - **確認**
        - アドオンがすべてプライベートウィンドウでは無効になっている。

    :2: 原則として許可する

    - ポリシー設定から `DisablePrivateBrowsing` の設定を削除し、プライベートウィンドウ機能を一時的に有効化しておく。
    - ポリシー設定から `BlockAboutAddons` の設定を削除し、アドオンマネージャを一時的に有効化しておく。
    - Firefoxを起動する。
    - アドオンマネージャを開く。
    - **確認**
        - アドオンがすべてプライベートウィンドウでも有効になっている。

Privacy-52: プライバシーに関する通知タブの表示の可否

    :1: 表示する（既定）

    - Privacy-18-3が選択されている場合、以下の手順を実施する。
        - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
        - Firefoxを起動する。
        - `about:config` を開く。
        - **確認**
            - `datareporting.policy.firstRunURL` の値が空文字である。
    - Privacy-18-3が選択されていない場合、以下の手順を実施する。
        - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル  
          `{{special_profile_path}}` {%if special_profile_actual_path %}  
          （{{special_profile_actual_path}}）{% endif %}  
          を空にする。
        - Firefoxを起動する。
        - **確認**
            - プライバシーポリシーの説明のためのタブがバックグラウンドで開かれている。

    :2: 表示しない

    - Privacy-18-3が選択されている場合、以下の手順を実施する。
        - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
        - Firefoxを起動する。
        - `about:config` を開く。
        - **確認**
            - `datareporting.policy.firstRunURL` の値が空文字である。
    - Privacy-18-3が選択されていない場合、以下の手順を実施する。
        - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル  
          `{{special_profile_path}}` {%if special_profile_actual_path %}  
          （{{special_profile_actual_path}}）{% endif %}  
          を空にする。
        - Firefoxを起動する。
        - **確認**
            - プライバシーポリシーの説明のためのタブがバックグラウンドで開かれていない。

Privacy-53: パスワードの自動生成機能の使用

    :1: 自動生成を許可する（既定）

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ログインとパスワード」配下の「強固なパスワードを生成、提案する」にチェックが入っている。

    :2: 無効化する

    - Firefoxを起動する。
    - パネルメニューからオプションを開く。
    - オプション画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「ログインとパスワード」配下の「強固なパスワードを生成、提案する」にチェックが入っておらず、選択不可になっている。
