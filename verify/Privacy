# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

Privacy-0: プライバシーの検証

   :1: 事前準備

    - 前項に引き続いて検証するか、{%if use_meta_installer %}または以下の状態を整えておく。
        - 作成済みの `{{meta_installer_file_name}}*.exe` を検証用ユーザーとして実行し、カスタマイズ済みFirefoxのインストールを完了している。
        - 管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    {% else %}再ログオン、インストーラの手動実行など、所定の手順でFirefoxのインストール及びカスタマイズを反映済みの状態とする。{% endif %}

Privacy-1: 履歴の保存の可否

    :2: 保存する（既定）

    OPTIONS

    - 「プライバシーとセキュリティ」→「履歴」が以下の通りになっている。
        - 以下のいずれかの状態になっている：
            - 「Firefoxに履歴を記憶させる」が選択されている。
            - 「記憶させる履歴を詳細設定」が選択されており、「常にプライベートブラウジングモード」のチェックが外れていて変更不可になっている。
            - 「記憶させる履歴を詳細設定」が選択されており、「常にプライベートブラウジングモード」の項目自体が存在しない。
        - 「記憶させる履歴を詳細設定する」が選択されている場合、以下のいずれかの状態になっている：
            - 「Firefox を閉じたときにCookieとサイトデータを削除する」のチェックが外れていて選択不可になっている。
            - 「Firefox を閉じたときにCookieとサイトデータを削除する」の項目が存在しない。

    :5: 履歴を基本的には保存し、ただし（一部項目は）終了時の消去を許可する / 起動時からのプライベートブラウジングの開始を無効

    - Firefoxを起動する。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「プライバシーとセキュリティ」→「履歴」が以下のいずれかの状態になっている：
            - 「Firefoxに履歴を記憶させる」が選択されている。
            - 「記憶させる履歴を詳細設定」が選択されており、「常にプライベートブラウジングモード」のチェックが外れて変更不可になっている。
            - 「記憶させる履歴を詳細設定」が選択されており、「常にプライベートブラウジングモード」の項目自体が存在しない。
            - （一部の履歴の削除を禁止する設定を導入した場合のみ）「Firefox を閉じたときにCookieとサイトデータを削除する」にチェックが入っている。

    :7: 保存を強制する

    OPTIONS

    - 「プライバシーとセキュリティ」→「履歴」が以下の通りになっている。
        - 以下のいずれかの状態になっている：
            - 「Firefoxに履歴を記憶させる」が選択され変更不可になっている。
            - 「記憶させる履歴を詳細設定」が選択されており、「常にプライベートブラウジングモード」のチェックが外れて変更不可になっている。
            - 「記憶させる履歴を詳細設定」が選択されており、「常にプライベートブラウジングモード」の項目自体が存在しない。
        - 「記憶させる履歴を詳細設定する」が選択されている場合、以下のいずれかの状態になっている：
            - 「Firefox を閉じたときにCookieとサイトデータを削除する」のチェックが外れていて選択不可になっている。
            - 「Firefox を閉じたときにCookieとサイトデータを削除する」の項目が存在しない。

    :3: 一切保存しない

    OPTIONS

    - 「プライバシーとセキュリティ」→「履歴」が以下の通りになっている。
        - 以下のいずれかの状態になっている：
            - 「Firefoxに履歴を一切記憶させない」が選択されている。
            - 「記憶させる履歴を詳細設定」が選択されており、「常にプライベートブラウジングモード」のチェックが入っていて変更不可になっている。
        - 「記憶させる履歴を詳細設定する」が選択されている場合、以下のいずれかの状態になっている：
            - 「Firefox を閉じたときにCookieとサイトデータを削除する」のチェックが外れていて選択不可になっている。
            - 「Firefox を閉じたときにCookieとサイトデータを削除する」の項目が存在しない。

    :6: 終了時に消去する

    - Firefoxを起動する。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Cookieとサイトデータ」→「Firefox を閉じたときにCookieとサイトデータを削除する」にチェックが入っている。
    - 「Firefox を閉じたときにCookieとサイトデータを削除する」のチェックを外す。
    - Firefoxを再起動する。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「Cookieとサイトデータ」→「Firefox を閉じたときにCookieとサイトデータを削除する」にチェックが入っている。
    - `about:policies` を開く。
    - `SanitizeOnShutdown` の設定値を確認する。
    - **確認**
        - 以下の項目の値が `true` である。
            - {{sanitize_on_shutdown_list}}

Privacy-2: フォームの入力履歴の保存の可否（Webページ上のフォーム要素、およびWeb検索バーのオートコンプリート機能の無効化）

    :1: 保存する（既定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードをそれぞれ「test」と入力して送信する。
    - テストケースの `password.html` が再度読み込まれたら、ユーザーID欄をダブルクリックする。
    - **確認**
        - 入力履歴が表示される。

    :3: 保存しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードをそれぞれ「test」と入力して送信する。
    - テストケースの `password.html` が再度読み込まれたら、ユーザーID欄をダブルクリックする。
    - **確認**
        - 入力履歴が表示されない。

Privacy-3: ダウンロード履歴の保存の可否

    :1: 永続的に保存する（既定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ファイルに名前を付けて保存する。
    - Firefoxを再起動する。
    - 「履歴」→「すべての履歴を表示」を選択する。
    - **確認**
        - 「ダウンロード」の一覧に項目が存在する。

    :3: 保存しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ファイルに名前を付けて保存する。
    - Firefoxを再起動する。
    - 「履歴」→「すべての履歴を表示」を選択する。
    - **確認**
        - 「ダウンロード」の一覧に項目が存在しない。

Privacy-4: アドレスバーの入力履歴の表示の可否

    :1: 表示する（既定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - Firefoxを再起動する。
    - アドレスバーに `password.html` と入力する。
    - **確認**
        - アドレスバーのオートコンプリートの項目として `password.html` の項目が表示される。

    :3: 表示しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - Firefoxを再起動する。
    - アドレスバーに `password.html` と入力する。
    - **確認**
        - アドレスバーのオートコンプリートの項目として `password.html` の項目が表示されない。

Privacy-5: パスワードの保存の可否

    :1: 確認の上で保存する（既定）

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードをそれぞれ「test」と入力して送信する。
    - **確認**
        - パスワードの保存を尋ねられる。
    - パスワードを保存する。
    - テストケースの `password.html` が再度読み込まれたら、パスワード欄をクリックする。
    - **確認**
        - 先ほど入力したパスワード情報が表示される。

    :4: 保存しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードをそれぞれ「test」と入力して送信する。
    - **確認**
        - パスワードの保存を尋ねられない。
    - テストケースの `password.html` が再度読み込まれたら、パスワード欄をクリックする。
    - **確認**
        - 先ほど入力したパスワード情報が表示されない。
    - パネルメニューを開く。
    - 「パスワード」を選択する。
    - **確認**
        - ページ遷移がブロックされる。

    :3: 保存せず、マスターパスワードも使用しない

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザーID、パスワードをそれぞれ「test」と入力して送信する。
    - **確認**
        - パスワードの保存を尋ねられない。
    - テストケースの `password.html` が再度読み込まれたら、パスワード欄をクリックする。
    - **確認**
        - 先ほど入力したパスワード情報が表示されない。
    - パネルメニューから「設定」を開く。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「パスワード」配下の「マスターパスワードを使用する」のチェックが外れていて、選択不可になっている。
    - パネルメニューを開く。
    - 「パスワード」を選択する。
    - **確認**
        - ページ遷移がブロックされる。

    :5: 確認の上で保存するが、特定サイトでのみ保存を禁止

    - パスワード保存禁止対象のサイトでのパスワード送信を試行できる状態を整える。 \
      もしくは、ポリシー設定を変更し `https://www.w3schools.com` をパスワード保存禁止対象に加える。
    - Firefoxを起動する。
    - パスワード保存禁止対象のサイトのパスワード送信画面、もしくは、テストケースリストのリンクから \
      `https://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_input_type_password` \
      を開く。
    - ユーザーID、パスワードを入力して送信する。 \
      デモサイトを使用する場合は、メールアドレス入力欄とパスワード欄の両方に \
      `example@example.com` \
      と入力して送信する。
    - **確認**
        - パスワードの保存を尋ねられない。
    - パスワード送信を試行したページを再度表示する。
    - パスワード入力欄をクリックする。
    - **確認**
        - 先ほど入力したパスワード情報が表示されない。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - 「パスワード」配下の「ウェブサイトのログイン情報とパスワードを保存する」の隣の「例外サイト...」をクリックする。
    - **確認**
        - パスワード保存禁止対象として、ポリシー設定で列挙したWebサイトがすべて表示される。

Privacy-7: リンク先の先読みの可否

    :1: 許可する（既定）

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューの「その他のツール」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - コンソール上の「要求」が選択された状態にする（すでに選択されていた場合は、一旦未選択状態に戻し、再度選択する）。
    - ブラウザーウィンドウでテストケースリストのリンクから \
      `https://www.clear-code.com/blog/2016/5/10.html` \
      を開く。
    - **確認**
        - `GET https://www.clear-code.com/blog/2016/5/18.html` \
          というログがコンソールに出力される。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}

    :2: 禁止する

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューの「その他のツール」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - コンソール上の「要求」が選択された状態にする（すでに選択されていた場合は、一旦未選択状態に戻し、再度選択する）。
    - ブラウザーウィンドウでテストケースリストのリンクから \
      `https://www.clear-code.com/blog/2016/5/10.html` \
      を開く。
    - **確認**
        - `GET https://www.clear-code.com/blog/2016/5/18.html` \
          というログがコンソールに出力されない。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}

Privacy-8: 履歴の最低保証保持件数（lazyな最大保持件数）

    :1: 指定しない（既定）

    ABOUT_CONFIG

    - `places.history.expiration.max_pages` が未定義である。

    :2: 指定する

    ABOUT_CONFIG

    - `places.history.expiration.max_pages` の値が `{{history_expiration_max_pages}}` である。

Privacy-9: 日数ベースでの履歴の自動削除

    :1: 日数ベースで履歴を自動削除する

    - システムの時刻を変更できる場合：
          {%if Security_3_3 %}
        - ポリシー設定から `BlockAboutAddons` を削除し、アドオンマネージャを一時的に有効化しておく。
          {% endif %}
          {%if Security_9_3 %}
        - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
          {% endif %}
        - Firefoxを起動する。
        - 十分な日数分の履歴項目を以下の手順で用意する。
            - システムの日付を直接変更する場合：
                1. システムの日付と時刻について、インターネット経由での調整を無効にする。
                   例えばWindowsであれば、タスクバーの時計を右クリックして「日付と時刻の調整」を選択し、「日付と時刻」ダイアログの「インターネット時刻」タブで「設定の変更」ボタンをクリックし、「インターネット時刻サーバーと同期する」のチェックを外す。（※要：管理者権限）
                2. システムの日付を(自動削除する日数＋2)日以上前の日付に変更する。
                3. Firefox上で何らかのWebページを開き、リンクを辿ってページを遷移する。
                4. この操作を、日付を1日ずつ進めながら繰り返す。
            - [HookDate](http://dsas.blog.klab.org/archives/51078742.html)を使用する場合：
                1. HookDateRegister.exe を実行してHookDateを登録済みの状態にする。
                2. HookDate.exe を起動する。
                3. プログラムの一覧に {{exe_name}} をドラッグ＆ドロップして登録する。
                4. {{exe_name}} の項目を編集し、日付を(自動削除する日数＋2)日以上前に設定し、変更を保存する。
                5. Firefoxを起動する。
                6. Firefox上で何らかのWebページを開き、リンクを辿ってページを遷移する。
                7. Firefoxを終了する。
                8. 4～7の操作を、日付を1日ずつ進めながら繰り返す。
        - パネルメニューを開き、「拡張機能」をクリックする。
        - アドオンマネージャ内の「拡張機能」をクリックする。
        - **確認**
            - 拡張機能の一覧に「Flexible Expire History by Days」が表示されており、有効になっている。
        - 「Flexible Expire History by Days」の設定画面を開く。
        - **確認**
            - 「Expire visits older than these days」の値が `(自動削除する日数)` である。
            - 「Frequency of expiration」で「On the first idle time per a day」が選択されている。
        - `about:config` を開く。
        - 「検索」欄に `idle.lastDailyNotification` と入力し、Enterを押す。
        - 項目が見つかった場合、項目の右端のごみ箱ボタンをクリックして値を消去する。
        - Firefoxを再起動する。
        - メニューバーの「履歴」から「すべての履歴を表示」を選択し、「ブラウジングライブラリー」ウィンドウを開く（すべての履歴項目を表示した状態にする）。
        - 「履歴」配下の「7日以内」、「（前月）月」、または指定の履歴保存期間のしきい値となる日付が含まれる期間を選択する。
        - 履歴一覧のカラム列を右クリックし、「最近表示した日時」にチェックを入れる。
        - **確認**
            - 当日までの日付の履歴項目が並んでいる。
        - マウスとキーボードから手を離し、4分以上、何も操作せずに放置する。
        - **確認**
            - 前日を含めて過去5日間の履歴が残っており、それよりも古い履歴項目が残っていない。
          {%if Security_9_3 %}
        - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
          {% endif %}
          {%if Security_3_3 %}
        - ポリシー設定から一時的に削除した `BlockAboutAddons` を元に戻す。
          {% endif %}
        - 変更したシステムの日付を元に戻す。
            - HookDateを使用した場合、HookDateRegister.exe を実行してHookDateを未登録の状態に戻す。
    - システムの時刻を変更できない場合：
          {%if Security_3_3 %}
        - ポリシー設定から `BlockAboutAddons` を削除し、アドオンマネージャを一時的に有効化しておく。
          {% endif %}
        - Firefoxを起動する。
        - パネルメニューを開き、「拡張機能」をクリックする。
        - アドオンマネージャ内の「拡張機能」をクリックする。
        - **確認**
            - 拡張機能の一覧に「Flexible Expire History by Days」が表示されており、有効になっている。
        - 「Flexible Expire History by Days」の設定画面を開く。
        - **確認**
            - 「Expire visits older than these days」の値が `(自動削除する日数)` である。
            - 「Frequency of expiration」で「On the first idle time per a day」が選択されている。
          {%if Security_3_3 %}
        - ポリシー設定から一時的に削除した `BlockAboutAddons` を元に戻す。
          {% endif %}

Privacy-10: セッション情報の保存の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - アドレスバーに `about:about` と入力し、Alt-Enterでタブとして開いてから、タブを閉じる。
    - 「履歴」メニューを開く。
    - **確認**
        - 「最近閉じたタブ」それ自体およびその配下の項目が表示される。

    :2: 禁止する

    - Firefoxを起動する。
    - アドレスバーに `about:about` と入力し、Alt-Enterでタブとして開いてから、タブを閉じる。
    - 「履歴」メニューを開く。
    - **確認**
        - 「最近閉じたタブ」それ自体もしくはその配下の項目が表示されない。

Privacy-11: Cookie、IndexedDB、Web Storage、およびService Worker用Cacheの保存の可否

    :1: 永続的に許可する（既定）

    ABOUT_POLICIES

    - `SanitizeOnShutdown` の `Cookies` の値が `true` である。

    :6: 既定では禁止し、特定サイトのみ永続的に許可する

    ABOUT_POLICIES

    - `Cookies` の `Default` の値が `false` である。
    - `Cookies` の `Allow` の値として許可サイトが列挙されている。

    :3: セッション中のみ許可する

    ABOUT_POLICIES

    - `SanitizeOnShutdown` の `Cookies` と `Locked` の値がどちらも `true` である。

    :4: 禁止する

    ABOUT_POLICIES

    - `Cookies` の `Default` の値が `false` である。

    :7: 既定では永続的に許可し、特定サイトのみ禁止する

    ABOUT_POLICIES

    - `Cookies` の `Default` の値が `true` である。
    - `Cookies` の `Allow` の値として禁止サイトが列挙されている。

    :8: 特定サイトでセッション中のみ許可する

    ABOUT_POLICIES

    - `Cookies` の `Default` の値が `false` である。
    - `SanitizeOnShutdown` の `Cookies` の値が `true` である。

Privacy-12: DOMストレージの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「localStorage」欄に `enabled` と出力される。

    :2: 禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「localStorage」欄に `disabled` と出力される。

Privacy-13: Indexed DBの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「indexedDB」欄に `enabled` と出力される。

    :3: 禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「indexedDB」欄に `disabled` と出力される。

Privacy-14: 位置情報の利用の可否

    :1: 確認の上で許可する（既定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると「このサイトに位置情報の共有を許可しますか？」と尋ねられる。

    :6: すべてのサイトについて初期状態で確認無しで禁止する（「位置情報へのアクセスの要求をブロック」にチェック）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると「fail: cannot fetch your location」というエラーが表示される。

    :7: すべてのサイトについて初期状態で確認無しで許可する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると確認なしで取得された座標が表示される。

    :5: 特定サイトのみ初期状態で確認なしで許可/禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると「このサイトに位置情報の共有を許可しますか？」と尋ねられる。
    - 確認無しでの位置情報の取得を許可するサイトが定義されている場合、以下の検証も行う。
        - 許可サイトを開き、アドレスバー左端のアイコン部分をクリックする。
            - **確認**
                - パネル上で、「位置情報の送信」が「許可」と表示される。
        - 「位置情報の送信」で「ブロック」を選択する。
        - Firefoxを再起動する
        - そのページを開き、アドレスバー左端のアイコン部分をクリックする。
            - **確認**
                - パネル上で、「位置情報の送信」が「ブロック」と表示される。

    :3: 禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `disabled` と出力される。

    :8: すべてのサイトについて初期状態で確認無しで禁止する（「位置情報へのアクセスの要求をブロック」にチェック）が、特定のサイトのみ許可する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「geolocation」欄に `enabled` と出力される。
        - 「geolocation」欄の「exec」をクリックすると「fail: cannot fetch your location」というエラーが表示される。
    - 許可サイト`{{ privacy_14_permissions_location_allow }}`を開き、アドレスバー左端のアイコン部分をクリックする。
    - **確認**
      - パネル上で、「位置情報の送信」が「許可」と表示される。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - 「プライバシーとセキュリティ」→「許可設定」→「位置情報」でウェブサイト`{{ privacy_14_permissions_location_allow }}`の現在の設定を「ブロック」にする。
    - Firefoxを再起動する
    - そのページを開き、アドレスバー左端のアイコン部分をクリックする。
    - **確認**
      - パネル上で、「位置情報の送信」が「許可」と表示される。(設定が固定されている)

Privacy-15: 検索結果のローカライズ用地域コードの位置情報に基づく推定の可否

    :1: 許可する（既定）

    ABOUT_CONFIG

    - `browser.search.geoip.url` の値が未定義や空でない。

    :2: 禁止する

    ABOUT_CONFIG

    - `browser.search.geoip.url` の値が空文字である。

Privacy-16: DNSの先読みの可否

    :1: 許可する（既定）

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `network.dns.notifyResolution`（真偽型）：`true`
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューで「その他のツール」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - 以下のコードをコンソール内で実行する。
      
              Services.obs.addObserver({observe:(s,t,d)=>console.log(t+': '+d)},
                                       'dns-resolution-request',
                                       false);
      
    - コンソール上の「要求」が選択された状態にする（すでに選択されていた場合は、一旦未選択状態に戻し、再度選択する）。
    - ブラウザーウィンドウでテストケースの `prefetching.html` を開く。
    - **確認**
        - `dns-resolution-request: dns-prefetch.example.com` というログがブラウザーコンソールに出力される。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}

    :2: 禁止する

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `network.dns.notifyResolution`（真偽型）：`true`
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューで「その他のツール」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - 以下のコードをコンソール内で実行する。
      
              Services.obs.addObserver({observe:(s,t,d)=>console.log(t+': '+d)},
                                       'dns-resolution-request',
                                       false);
      
    - コンソール上の「要求」が選択された状態にする（すでに選択されていた場合は、一旦未選択状態に戻し、再度選択する）。
    - ブラウザーウィンドウでテストケースの `prefetching.html` を開く。
    - **確認**
        - `dns-resolution-request: dns-prefetch.example.com` というログがブラウザーコンソールに出力されない。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}

Privacy-17: 検索エンジンの候補表示（Suggest）の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - ツールバー上のアドレスバーまたは検索窓にフォーカスし `a` と入力する。
    - **確認**
        - `a` の補完候補が表示される。
    - ツールバー上のアドレスバーにフォーカスし「新しい検索語句」等、履歴やブックマーク等からの候補が表示され得ないテキストを入力する。
    - **確認**
        - 補完候補が表示される。
    - 設定画面の「検索」タブから「既定の検索エンジン」欄を確認する。
    - **確認**
        - 「検索候補を表示する」にチェックが入っている。
        - 「検索候補を表示する」が選択不可になっているか、チェックを外して設定画面を開き直すとチェックが入った状態に戻っている。
        - 「アドレスバーに検索候補を表示する」にチェックが入っている。
        - 「アドレスバーに検索候補を表示する」が選択不可になっているか、チェックを外して設定画面を開き直すとチェックが入った状態に戻っている。

    :3: 禁止する

    - Firefoxを起動する。
    - ツールバー上のアドレスバーまたは検索窓にフォーカスし `ab` と入力する。
    - **確認**
        {% if Privacy_4_3 %}
        - `ab` の補完候補(abcマートなど)が表示されない。(Firefox Suggestも表示されない)
        {% else %}
        - `ab` の補完候補(abcマートなど)が表示されない。(Firefox Suggestとしてブックマークや開いているタブ、履歴の補完は表示される)
        {% endif %}
    - ツールバー上のアドレスバーにフォーカスし「新しい検索語句」等、履歴やブックマーク等からの候補が表示され得ないテキストを入力する。
    - **確認**
        - 補完候補が表示されない。
    - 設定画面の「検索」タブから「既定の検索エンジン」欄を確認する。
    - **確認**
        - 「検索候補を表示する」のチェックが外れていて選択不可になっている。
        - 「検索候補を表示する」が選択不可になっているか、チェックを入れて設定画面を開き直すとチェックが外れた状態に戻っている。
        - 「アドレスバーに検索候補を表示する」のチェックが外れている。
        - 「アドレスバーに検索候補を表示する」が選択不可になっているか、チェックを入れて設定画面を開き直すとチェックが外れた状態に戻っている。

Privacy-18: 利用状況の統計の保存および送信の可否

    :1: 許可する（既定）

    OPTIONS

    - 「プライバシーとセキュリティ」→「Firefoxが技術的な対話データをMozillaへ送信することを許可する」にチェックが入っている。

    :3: 禁止する

    ABOUT_POLICIES

    - `DisableDefaultBrowserAgent` の値が `true` である。
    - `DisableTelemetry` の値が `true` である。

Privacy-19: セキュリティエラーレポートの送信の可否

    :1: 許可する（既定）

    ABOUT_CONFIG

    - `security.ssl.errorReporting.enabled` の値が `true` である。

    :2: 禁止する

    ABOUT_CONFIG

    - `security.ssl.errorReporting.enabled` の値が `false` である。

Privacy-21: クラッシュレポートの送信の可否

    :1: 許可する（既定）

    OPTIONS

    - 「プライバシーとセキュリティ」→「クラッシュレポートを自動的に送信する」にチェックが入っている。

    :2: 禁止する

    OPTIONS

    - 「プライバシーとセキュリティ」→「クラッシュレポートを自動的に送信する」のチェックが外れている。

    :3: レジストリでグローバルに禁止する

    - Windowsキーを押しながら「R」を押し、「ファイル名を指定して実行」ダイアログを開く。
    - `regedit.exe` と入力し、実行する。
      管理者権限を要求された場合は、`管理者`ユーザーで認証する。
    - `HKEY_LOCAL_MACHINE\SOFTWARE\Mozilla\Firefox\Crash Reporter` \
      （32bit版Firefoxを64bit環境で使用している場合は \
      `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Mozilla\Firefox\Crash Reporter` ） \
      を開く。
    - **確認**
        - 値 `SubmitCrashReport` のデータが `0` である。
        - 値 `Enabled` のデータが `0` である。

Privacy-22: Firefox Syncの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「同期してデータを保存」の項目が存在する。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「ログイン」の項目が存在する。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「Firefoxアカウント」が存在する。

    :2: 禁止する

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「同期してデータを保存」の項目が存在しない。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「ログイン」の項目が存在しない。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「Firefoxアカウント」が存在しない。

Privacy-24: Firefoxアカウントの利用の可否

    :1: 許可する（既定）: DisableSync

    - Privacy-22の検証と重複するため省略

    :1: 許可する（既定）: not DisableSync

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「同期してデータを保存」の項目が存在する。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「ログイン」の項目が存在する。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「Firefoxアカウント」が存在する。

    :2: 禁止する: DisableSync

    - Privacy-22の検証と重複するため省略

    :2: 禁止する: not DisableSync

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「同期してデータを保存」の項目が存在しない。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「ログイン」の項目が存在しない。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「Firefoxアカウント」が存在しない。

    :3: 禁止する: DisableSync

    - Privacy-22の検証と重複するため省略

    :3: 禁止する: not DisableSync

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「同期してデータを保存」の項目が存在しない。
    - メニューバーの「ツール」メニューを開く。
    - **確認**
        - 「ログイン」の項目が存在しない。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「Firefoxアカウント」が存在しない。

Privacy-26: 「忘れる」ボタンの利用の可否

    :1: 許可する（既定）

    - Firefoxを起動する。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「忘れる」が存在する。

    :2: 禁止する

    - Firefoxを起動する。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「忘れる」が存在しない。

Privacy-27: Pocket（リーディングリスト機能）の利用の可否

    :1: 許可する

    - Firefoxを起動する。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「Pocket」が存在する。
    - Webページ中の任意のリンクを右クリックしてコンテキストメニューを開く。
      例えば、`https://example.com/` を開いて「More information」のリンクを右クリックする。
    - **確認**
        - 「リンクをPocketに保存」が存在する。

    :3: 禁止する

    - Firefoxを起動する。
    - ツールバーを右クリックしてカスタマイズ画面を開く。
    - **確認**
        - 「Pocket」が存在しない。
    - Webページ中の任意のリンクを右クリックしてコンテキストメニューを開く。
      例えば、`https://example.com/` を開いて「More information」のリンクを右クリックする。
    - **確認**
        - 「リンクをPocketに保存」が存在しない。

Privacy-29: 履歴・ブックマーク用データベースの自動最適化

    :1: 1週間に1回、最低限の最適化のみ行う（既定）

    {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
      {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を新規に作成する（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `idle.lastDailyNotification`（整数型）：`0`
        - `places.database.lastMaintenance`（整数型）：`0`
    - Firefoxを再起動する。
    - パネルメニューの「その他のツール」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - キーボード、マウスから手を離し、4分以上待つ。
    - **確認**
        - ブラウザーコンソールに以下のメッセージが1つも表示されない。
            - `PlacesDBUtils.maintenanceOnIdle() is called and redirected to checkAndFixDatabase().`
            - `PlacesDBUtils.checkAndFixDatabase() successfully finished.`
            - `The database has been vacuumed.`
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}

    :2: 1週間に1回、VACUUMも含めて行う

    {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
      {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を新規に作成する（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `idle.lastDailyNotification`（整数型）：`0`
        - `places.database.lastMaintenance`（整数型）：`0`
    - Firefoxを再起動する。
    - パネルメニューの「その他のツール」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - キーボード、マウスから手を離し、4分以上待つ。
    - **確認**
        - ブラウザーコンソールに以下のメッセージがすべて出力される。
            - `PlacesDBUtils.maintenanceOnIdle() is called and redirected to checkAndFixDatabase().`
            - `PlacesDBUtils.checkAndFixDatabase() successfully finished.`
            - `The database has been vacuumed.`
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}

Privacy-30: ディスクキャッシュの最大サイズ制限

    :1: 制限しない（既定）

    - Firefoxを起動する。
    - `about:cache` を開く。
    - **確認**
        - 「disk」欄の「Maximum storage size」の値が `1048576` などの自動算出された値になっている。

    :2: 制限する

    - Firefoxを起動する。
    - `about:cache` を開く。
    - **確認**
        - 「disk」欄の「Maximum storage size」の値が指定値と一致している。

    :3: ディスクキャッシュを使用しない

    - Firefoxを起動する。
    - `about:cache` を開く。
    - **確認**
        - 「disk」欄の「Storage disk location」に「none, only stored in memory」と表示されている。
    - `{{special_profile_path}}\{{special_profile_name}}\cache2` \
      もしくは \
      `%LocalAppData%\Mozilla\Firefox\Profiles\（現在のプロファイルに対応するフォルダ名）\cache2` \
      を開き、その中の `entries` フォルダを開く。
    - **確認**
        - フォルダが空である。

Privacy-32: リンクのhoverによるリンク先の先読みの可否

    :1: 許可する（既定）

    ABOUT_CONFIG

    - `network.http.speculative-parallel-limit` が `1` またはそれ以上である。

    :2: 禁止する

    ABOUT_CONFIG

    - `network.http.speculative-parallel-limit` が `0` である。

Privacy-33: Webサービスによる行動履歴の収集（トラッキング）の遮断の可否

    :1: ブロックリストを取得して、プライベートブラウジング時のみトラッキングを遮断する（ESR68で既定）

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `false` である。
    - `privacy.trackingprotection.pbmode.enabled` が `true` である。

    :2: ブロックリストを取得して、トラッキングを常に遮断する（既定）

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `true` である。
    - `privacy.trackingprotection.pbmode.enabled` が `true` である。

    :4: ブロックリストを取得して、トラッキングを常に遮断する（ポリシー設定を併用）

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `true` である。
    - `privacy.trackingprotection.pbmode.enabled` が `true` である。

    :5: ブロックリストを取得せず、トラッキングを遮断しない

    ABOUT_CONFIG

    - `privacy.trackingprotection.enabled` が `false` である。
    - `privacy.trackingprotection.pbmode.enabled` が `false` である。

Privacy-34: フォームへのユーザー入力値のセッション情報への保存の可否

    :1: 許可する（既定）

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル \
      `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} \
      （{{Application_6_2_special_profile_actual_path}}）{% endif %} \
      を削除する。
    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザID欄に「ユーザ入力値」と入力し、20秒待つ。
    - ユーザープロファイル内の `sessionstore-backups` フォルダを開く。
    - `recovery.jsonlz4` の内容を確認する。
        - Windowsの場合: https://github.com/jusw85/mozlz4/releases で公開されているバイナリを使って `mozlz4-win64.exe recovery.jsonlz4` を実行してJSONに変換し、Firefoxで開く。"ユーザー入力値"が見つかるかどうかを調べる。
	- Linuxの場合: `sudo npm install -g mozlz4a` で必要なコマンドをインストールした後、`mozlz4a-decompress recovery.jsonlz4  | jq . | grep "ユーザ入力値"` を実行して、行が見つかるかどうかを調べる。
    - **確認**
        - ファイル内に「ユーザ入力値」という文字列が含まれている。

    :2: 一切禁止する

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル \
      `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} \
      （{{Application_6_2_special_profile_actual_path}}）{% endif %} \
      を削除する。
    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザID欄に「ユーザ入力値」と入力し、20秒待つ。
    - ユーザープロファイル内の `sessionstore-backups` フォルダを開く。
    - **確認**
        - `recovery.jsonlz4` が存在しない。
          存在する場合は以下の手順を続けて行う。
    - `recovery.jsonlz4` の内容を確認する。
        - Windowsの場合: https://github.com/jusw85/mozlz4/releases で公開されているバイナリを使って `mozlz4-win64.exe recovery.jsonlz4` を実行してJSONに変換し、Firefoxで開く。"ユーザー入力値"が見つかるかどうかを調べる。
        - Linuxの場合: `sudo npm install -g mozlz4a` で必要なコマンドをインストールした後、`mozlz4a-decompress recovery.jsonlz4  | jq . | grep "ユーザ入力値"` を実行して、行が見つかるかどうかを調べる。
    - **確認**
        - ファイル内に「ユーザ入力値」という文字列が含まれていない。

Privacy-35: トラッキングの遮断に使用するブロックリストの指定

    :1: レベル1（基本）ブロックを初期設定とし、変更を許可（既定）

    ABOUT_CONFIG

    - `urlclassifier.trackingTable` が `moztest-track-simple,ads-track-digest256,social-track-digest256,analytics-track-digest256` に設定されている。

    :2: レベル2（厳格）ブロックを初期設定とし、変更を許可

    ABOUT_CONFIG

    - `urlclassifier.trackingTable` が `moztest-track-simple,ads-track-digest256,social-track-digest256,analytics-track-digest256,content-track-digest256` に設定されている。

    :3: レベル1（基本）ブロックで固定

    ABOUT_CONFIG

    - `urlclassifier.trackingTable` が `moztest-track-simple,ads-track-digest256,social-track-digest256,analytics-track-digest256` に固定されている。

    :4: レベル2（厳格）ブロックで固定

    ABOUT_CONFIG

    - `urlclassifier.trackingTable` が `moztest-track-simple,ads-track-digest256,social-track-digest256,analytics-track-digest256,content-track-digest256` に固定されている。

Privacy-36: TLS/SSLで保護された通信のコンテンツのディスク上へのキャッシュ

    :1: 許可する（既定）

    {%if Privacy_30_3 %}
    - ディスクキャッシュ無効化済みのため省略
    {% else %}
    {%if Tab_17_2 %}
    - ポリシー設定の `Preferences` から `browser.ctrlTab.sortByRecentlyUsed` の記述を削除する。
      {% endif %}
      {%if Privacy_30_3 %}
    - ユーザープロファイルフォルダと、`%LocalAppDir%\Mozilla\Firefox\Profiles\（プロファイルフォルダと同一の名前）` を開く。
    - `thumbnails` フォルダがあれば、それぞれのフォルダから消去する。
      {% else %}
    - Firefoxを起動する。
    - `about:cache` を開く。
    - `disk` 配下の `Storage disk location:` に記載されている位置のフォルダを開く。
    - Firefoxを終了する。
    - 先ほど開いたディスクキャッシュの保存先フォルダを開き、その1つ上位のフォルダに移動して、中にある `thumbnails` フォルダを消去する。
      {% endif %}
      {% if Application_6_2 %}
    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} （{{Application_6_2_special_profile_actual_path}}）{% endif %} 内のファイルを削除する。
      {% endif %}
    - Firefoxを起動する。
      {%if Tab_17_2 %}
    - パネルメニューから「設定」を開き、「一般」→「タブグループ」→「Ctrl+Tabで最近使用した順にタブを切り替える」にチェックが入っていなければチェックを入れる。
      {% endif %}
    - テストケースリストのリンクから `https://addons.mozilla.org/` を開く。
      （アドレスバーから`addons.mozilla.org`とホスト名のみ入力するなどの操作だと、TLSで保護されていない通信が発生する恐れがあるため、必ずこのURLを開く。）
    - サイト内のリンクから新しいタブを2～3個開く。
    - Ctrl-Tab を押し、サムネイルが表示されるのを待つ。
    - **確認**
        - ディスクキャッシュの保存先フォルダの上位フォルダ内にある `thumbnails` フォルダに addons.mozilla.org のページのサムネイル画像が保存される。
      {%if Tab_17_2 %}
    - パネルメニューから「設定」を開き、「一般」→「タブグループ」→「Ctrl+Tabで最近使用した順にタブを切り替える」のチェック状態を検証前の状態に戻す。
    - ポリシー設定の `Preferences` から削除した `browser.ctrlTab.sortByRecentlyUsed` の記述を戻す。
      {% endif %}
    {% endif %}

    :2: 禁止する

    {%if Privacy_30_3 %}
    - ディスクキャッシュ無効化済みのため省略
    {% else %}
    {%if Tab_17_2 %}
    - ポリシー設定の `Preferences` から `browser.ctrlTab.sortByRecentlyUsed` の記述を削除する。
      {% endif %}
      {%if Privacy_30_3 %}
    - ユーザープロファイルフォルダと、`%LocalAppDir%\Mozilla\Firefox\Profiles\（プロファイルフォルダと同一の名前）` を開く。
    - `thumbnails` フォルダがあれば、それぞれのフォルダから消去する。
      {% else %}
    - Firefoxを起動する。
    - `about:cache` を開く。
    - `disk` 配下の `Storage disk location:` に記載されている位置のフォルダを開く。
    - Firefoxを終了する。
    - 先ほど開いたディスクキャッシュの保存先フォルダを開き、その1つ上位のフォルダに移動して、中にある `thumbnails` フォルダを消去する。
      {% endif %}
      {% if Application_6_2 %}
    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} （{{Application_6_2_special_profile_actual_path}}）{% endif %} 内のファイルを削除する。
      {% endif %}
    - Firefoxを起動する。
      {%if Tab_17_2 %}
    - パネルメニューから「設定」を開き、「一般」→「タブグループ」→「Ctrl+Tabで最近使用した順にタブを切り替える」にチェックが入っていなければチェックを入れる。
      {% endif %}
    - テストケースリストのリンクから `https://addons.mozilla.org/` を開く。
      （アドレスバーから`addons.mozilla.org`とホスト名のみ入力するなどの操作だと、TLSで保護されていない通信が発生する恐れがあるため、必ずこのURLを開く。）
    - サイト内のリンクから新しいタブを2～3個開く。
    - Ctrl-Tab を押し、サムネイルが表示されるのを待つ。
    - **確認**
        - ディスクキャッシュの保存先フォルダの上位フォルダ内に `thumbnails` フォルダが作成されない、もしくは、`thumbnails` フォルダに addons.mozilla.org のページのサムネイル画像が保存されない。
      {%if Tab_17_2 %}
    - パネルメニューから「設定」を開き、「一般」→「タブグループ」→「Ctrl+Tabで最近使用した順にタブを切り替える」のチェック状態を検証前の状態に戻す。
    - ポリシー設定の `Preferences` から削除した `browser.ctrlTab.sortByRecentlyUsed` の記述を戻す。
      {% endif %}
    {% endif %}

Privacy-37: ネットワーク経由での先読み機能の全般的な制御

    :1: 先読みを許可する（既定）: 先読み対象となるページのホスト名がグローバルIPアドレスに解決されるなど、先読みが行われる環境の場合

      {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
    - MCD設定ファイルに以下の設定を追加しておく。
      
          lockPref("logging.nsHttp", 5);
          lockPref("logging.NetworkPredictor", 5);
          lockPref("logging.config.sync", true);
          lockPref("logging.config.add_timestamp", true);
          lockPref("logging.config.LOG_FILE","C:\\Users\\Public\\http.log");
    - `C:\Users\Public\http.log-*` を全て削除しておく。
    - Firefoxを起動する。
    - `https://www.clear-code.com/blog/` を開く。
    - 記事の個別ページを10ページほど訪問する。
    - Firefoxを終了する。
    - MCD設定ファイルに追加した設定を削除または無効化する。
    - Firefoxを起動する。
    - テストケースの `httplog.html` を開き、スクリプトをコピーする。
    - `C:\Users\Public\http.log` の位置に出力されているログファイル（複数ある場合はサイズが最も大きい物）をFirefoxで開く。
    - 「Ctrl-Shift-K」でコンソールを開く。
    - コピーしたスクリプトを貼り付けて、実行する。
    - コンソールに「No prediction is logged.」と出力される場合、以降の確認は実施せず、`about:config` で設定値を確認する方法をもって検証を行う。
    - **確認**
        - コンソールに「Predictor module is disabled.」と出力されない。
        - コンソールに出力された「success」と「fail」の値の合計が0でない。
        - コンソールに「All cancelled? false」と出力される。
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}
    - `C:\Users\Public\http.log-*` を全て削除しておく。

    :1: 先読みを許可する（既定）: 先読み対象となるページのホスト名がプライベートIPアドレスに解決されるなど、先読みが行われない環境の場合

    ABOUT_CONFIG

    - `network.predictor.enabled` の値が `true` である。

    :2: 先読みを禁止する: 先読み対象となるページのホスト名がグローバルIPアドレスに解決されるなど、先読みが行われる環境の場合

    {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
    - MCD設定ファイルに以下の設定を追加しておく。
      
          lockPref("logging.nsHttp", 5);
          lockPref("logging.NetworkPredictor", 5);
          lockPref("logging.config.sync", true);
          lockPref("logging.config.add_timestamp", true);
          lockPref("logging.config.LOG_FILE","C:\\Users\\Public\\http.log");
    - `C:\Users\Public\http.log-*` を全て削除しておく。
    - Firefoxを起動する。
    - `https://www.clear-code.com/blog/` を開く。
    - 記事の個別ページを10ページほど訪問する。
    - Firefoxを終了する。
    - MCD設定ファイルに追加した設定を削除または無効化する。
    - Firefoxを起動する。
    - テストケースの `httplog.html` を開き、スクリプトをコピーする。
    - `C:\Users\Public\http.log` の位置に出力されているログファイル（複数ある場合はサイズが最も大きい物）をFirefoxで開く。
    - 「Ctrl-Shift-K」でコンソールを開く。
    - コピーしたスクリプトを貼り付けて、実行する。
    - コンソールに「No prediction is logged.」と出力される場合、以降の確認は実施せず、`about:config` で設定値を確認する方法をもって検証を行う。
    - **確認**
        - コンソールに「Predictor module is disabled.」と出力される。もしくは、以下の2つの条件を両方とも満たしている。
           - コンソールに出力された「success」と「fail」の値の合計が0でない。
           - コンソールに「All cancelled? true」と出力される。
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}
    - `C:\Users\Public\http.log-*` を全て削除しておく。

    :2: 先読みを禁止する: 先読み対象となるページのホスト名がプライベートIPアドレスに解決されるなど、先読みが行われない環境の場合

    ABOUT_CONFIG

    - `network.predictor.enabled` の値が `false` である。

Privacy-38: Webビーコンの送信

    :1: 許可する（既定）

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「beacon」欄に `enabled` と表示される。

    :2: 禁止する

    - Firefoxを起動する。
    - テストケースの `browser.html` を開く。
    - **確認**
        - 「beacon」欄に `disabled` と表示される。

Privacy-39: SSL/TLSでないページへのパスワード入力時の警告

    :1: 警告する（既定）

    - Firefoxを起動する。
    - テストケースの `insecure-password.html` を開く。
    - パスワードの入力欄にフォーカスを移す。
    - **確認**
        - 安全でないフォームである旨の警告のメッセージが表示される。

    :2: 警告しない

    - Firefoxを起動する。
    - テストケースの `insecure-password.html` を開く。
    - パスワードの入力欄にフォーカスを移す。
    - **確認**
        - 安全でないフォームである旨の警告のメッセージが表示されない。

Privacy-40: パスワード保存ポップアップにおける、パスワードを平文表示するチェックボックスの表示の可否

    :1: 表示する（既定）: OfferToSaveLogins

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザID、パスワードをそれぞれ「test」と入力して送信する。
    - **確認**
        - パスワードの保存を提案するポップアップが表示され、その中に「パスワードを開示」チェックボックスが表示される。

    :1: 表示する（既定）: not OfferToSaveLogins

    ABOUT_CONFIG

    - `signon.rememberSignons.visibilityToggle` の値が `true` である。

    :2: 表示しない: OfferToSaveLogins

    - Firefoxを起動する。
    - テストケースの `password.html` を開く。
    - ユーザID、パスワードをそれぞれ「test」と入力して送信する。
    - **確認**
        - パスワードの保存を提案するポップアップが表示され、その中に「パスワードを開示」チェックボックスが表示されない。

    :2: 表示しない: not OfferToSaveLogins

    ABOUT_CONFIG

    - `signon.rememberSignons.visibilityToggle` の値が `false` である。

Privacy-41: トラッキング保護機能の通知メッセージの表示

    :1: 20回まで表示する（既定）

    - Firefoxを起動する。
    - テストケースリストのリンクから `http://www.kantei.go.jp/` を開く。
        - トラッキング保護機能が働いた旨の通知ポップアップが表示される。

    :2: 表示しない

    - Firefoxを起動する。
    - テストケースリストのリンクから `http://www.kantei.go.jp/` を開く。
        - トラッキング保護機能が働いた旨の通知ポップアップが表示されない。

Privacy-42: Firefoxの新機能のテストへの参加の可否

    :1: 参加する

    ABOUT_POLICIES

    - `DisableFirefoxStudies` の値が `false` である。

    :2: 参加しない

    ABOUT_POLICIES

    - `DisableFirefoxStudies` の値が `true` である。

Privacy-43: 「Do Not Track」ヘッダの送出の可否

    :1: プライベートウィンドウもしくはトラッキング保護が「厳格」の時のみ送出(既定)

    ABOUT_CONFIG

    - `privacy.donottrackheader.enabled` の値が `false` である。

    :2: 常に送る

    OPTIONS

    - 「プライバシーとセキュリティ」→「ウェブサイトに"Do Not Track"要求を送る」チェックボックスがONである。

    :3: [廃止] プライベートウィンドウのみ送出

    [廃止]

    :4: 送出しない

    - Firefoxを起動する。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - **確認**
        - 「強化型トラッキング防止機能」→「カスタム」→「トラッキングコンテンツ」チェックボックスがOFFである。
    - `about:config` を開く。
    - **確認**
        - `privacy.donottrackheader.enabled` の値が `false` である。

Privacy-44: 通常モードでのリファラの通知ポリシー

    :1: 一切通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy` の値が `0` である。

    :2: オリジンが同じである場合はパスまで含むURLを通知・それ以外は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy` の値が `1` である。

    :3: オリジンが同じである場合はパスまで含むURLを通知・オリジンが異なる場合はオリジンまでを通知・セキュリティレベルが異なる場合は通知しない（既定）

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy` の値が `2` である。

    :4: セキュリティレベルが同じである場合はオリジンの違いに関わらずパスまで含むURLを通知・セキュリティレベルが異なる場合は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy` の値が `3` である。

Privacy-45: プライベートブラウジングモードでのリファラの通知ポリシー

    :1: 一切通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.pbmode` の値が `0` である。

    :2: オリジンが同じである場合はパスまで含むURLを通知・それ以外は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.pbmode` の値が `1` である。

    :3: オリジンが同じである場合はパスまで含むURLを通知・オリジンが異なる場合はオリジンまでを通知・セキュリティレベルが異なる場合は通知しない（既定）

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.pbmode` の値が `2` である。

    :4: セキュリティレベルが同じである場合はオリジンの違いに関わらずパスまで含むURLを通知・セキュリティレベルが異なる場合は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.pbmode` の値が `3` である。

Privacy-46: カメラの利用の可否

    :1: 確認の上で許可する（既定）

    ABOUT_CONFIG

    - `permissions.default.camera` の値が `0` である。

    :5: 特定サイトのみ初期状態で確認なしで許可/禁止する

    OPTIONS

    - 「プライバシーとセキュリティ」→「許可設定」→「カメラ」→「設定」で、`default.permissions` で `1` を設定したサイトが許可サイトとして、`2` を設定したサイトが禁止サイトとして表示される。

    :3: すべてのサイトについて初期状態で確認無しで許可する

    OPTIONS

    - 「プライバシーとセキュリティ」→「許可設定」→「カメラ」→「設定」→「カメラへのアクセスの要求をブロック」のチェックが外れている。

    :4: すべてのサイトについて初期状態で確認無しで禁止する（「カメラへのアクセスの要求をブロック」にチェック）

    OPTIONS

    - 「プライバシーとセキュリティ」→「許可設定」→「カメラ」→「設定」→「カメラへのアクセスの要求をブロック」にチェックが入っている。

Privacy-47: マイクの利用の可否

    :1: 確認の上で許可する（既定）

    ABOUT_CONFIG

    - `permissions.default.microphone` の値が `0` である。

    :5: 特定サイトのみ初期状態で確認なしで許可/禁止する

    ABOUT_CONFIG

    - `permissions.default.microphone` の値が `0` である。

    :3: すべてのサイトについて初期状態で確認無しで許可する

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - パネルメニューから「設定」を開く。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - 「許可設定」→「マイク」→「設定」を開く。
    - **確認**
        - 「マイクへのアクセスの要求をブロック」のチェックが外れている。
    - `about:config` を開く。
    - **確認**
        - `permissions.default.microphone` の値が `1` である。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}

    :4: すべてのサイトについて初期状態で確認無しで禁止する（「マイクへのアクセスの要求をブロック」にチェック）

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - パネルメニューから「設定」を開く。
    - 設定画面の「プライバシーとセキュリティ」を開く。
    - 「許可設定」→「マイク」→「設定」を開く。
    - **確認**
        - 「マイクへのアクセスの要求をブロック」にチェックが入っている。
    - `about:config` を開く。
    - **確認**
        - `permissions.default.microphone` の値が `2` である。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}

Privacy-48: リファラの通知の有無

    :1: リンクの遷移、埋め込み画像の取得時に通知（既定）

    ABOUT_CONFIG

    - `network.http.sendRefererHeader` の値が `2` である。

    :2: リンクの遷移時にのみ通知

    ABOUT_CONFIG

    - `network.http.sendRefererHeader` の値が `1` である。

    :3: 一切通知しない

    ABOUT_CONFIG

    - `network.http.sendRefererHeader` の値が `0` である。

Privacy-49: 通常モードでの行動履歴のトラッキングに対するリファラの通知ポリシー

    :1: 一切通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers` の値が `0` である。

    :2: オリジンが同じである場合はパスまで含むURLを通知・それ以外は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers` の値が `1` である。

    :3: オリジンが同じである場合はパスまで含むURLを通知・オリジンが異なる場合はオリジンまでを通知・セキュリティレベルが異なる場合は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers` の値が `2` である。

    :4: セキュリティレベルが同じである場合はオリジンの違いに関わらずパスまで含むURLを通知・セキュリティレベルが異なる場合は通知しない（既定）

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers` の値が `3` である。

Privacy-50: プライベートブラウジングモードでの行動履歴のトラッキングに対するリファラの通知ポリシー

    :1: 一切通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers.pbmode` の値が `0` である。

    :2: オリジンが同じである場合はパスまで含むURLを通知・それ以外は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers.pbmode` の値が `1` である。

    :3: オリジンが同じである場合はパスまで含むURLを通知・オリジンが異なる場合はオリジンまでを通知・セキュリティレベルが異なる場合は通知しない（既定）

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers.pbmode` の値が `2` である。

    :4: セキュリティレベルが同じである場合はオリジンの違いに関わらずパスまで含むURLを通知・セキュリティレベルが異なる場合は通知しない

    ABOUT_CONFIG

    - `network.http.referer.defaultPolicy.trackers.pbmode` の値が `3` である。

Privacy-51: プライベートウィンドウでのアドオンの動作可否

    :1: 原則として禁止し、個別に許可する（既定）

    {%if MenuShortcut_3_1 %}
    - ポリシー設定から `DisablePrivateBrowsing` を削除し、プライベートウィンドウ機能を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - プライベートウィンドウを開く。
    - **確認**
        - アドオンがすべて無効になっている。
    - 拡張機能パネルを開く。
    - **確認**
        - アドオンアドオンがすべてプライベートウィンドウでは無効になっている。
      {%if MenuShortcut_3_1 %}
    - ポリシー設定から一時的に削除した `DisablePrivateBrowsing` を元に戻す。
      {% endif %}

    :2: 原則として許可する

    {%if MenuShortcut_3_1 %}
    - ポリシー設定から `DisablePrivateBrowsing` を削除し、プライベートウィンドウ機能を一時的に有効化しておく。
      {% endif %}
      {%if Security_3_3 %}
    - ポリシー設定から `BlockAboutAddons` を削除し、アドオンマネージャを一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - プライベートウィンドウを開く。
    - **確認**
        - アドオンがすべて有効になっている。
    - アドオンマネージャを開く。
    - **確認**
        - 各アドオンの詳細画面において、プライベートウィンドウでの使用の可否が許可になっている。もしくは、プライベートウィンドウでの使用可否の設定が表示されていない。
      {%if Security_3_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutAddons` を元に戻す。
      {% endif %}
      {%if MenuShortcut_3_1 %}
    - ポリシー設定から一時的に削除した `DisablePrivateBrowsing` を元に戻す。
      {% endif %}

Privacy-52: プライバシーに関する通知タブの表示の可否

    :1: 表示する（既定）: Privacy_18_3

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - **確認**
        - `datareporting.policy.firstRunURL` の値が空文字である。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}

    :1: 表示する（既定）: not Privacy_18_3

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル \
      `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} \
      （{{Application_6_2_special_profile_actual_path}}）{% endif %} \
      を空にする。
    - Firefoxを起動する。
    - **確認**
        - プライバシーポリシーの説明のためのタブがバックグラウンドで開かれている。

    :2: 表示しない: Privacy_18_3

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - **確認**
        - `datareporting.policy.firstRunURL` の値が空文字である。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}

    :2: 表示しない: not Privacy_18_3

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル \
      `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} \
      （{{Application_6_2_special_profile_actual_path}}）{% endif %} \
      を空にする。
    - Firefoxを起動する。
    - **確認**
        - プライバシーポリシーの説明のためのタブがバックグラウンドで開かれていない。

Privacy-53: パスワードの自動生成機能の使用

    :1: 自動生成を許可する（既定）

    OPTIONS

    - 「プライバシーとセキュリティ」→「パスワード」→「強固なパスワードを生成、提案する」にチェックが入っている。

    :2: 無効化する

    OPTIONS

    - 「プライバシーとセキュリティ」→「パスワード」→「強固なパスワードを生成、提案する」のチェックが外れていて、選択不可になっている。

Privacy-54: supercookieによるユーザー識別の遮断

    :1: 遮断する（既定）

    ABOUT_CONFIG

    - `privacy.partition.network_state` の値が `true` である。

    :2: 遮断しない

    ABOUT_CONFIG

    - `privacy.partition.network_state` の値が `false` である。

Privacy-55: クロスサイトCookieのブロック

    :1: ブロックする

    ABOUT_CONFIG

    - `network.cookie.cookieBehavior` の値が `5` である。
    - `network.cookie.cookieBehavior.pbmode` の値が `5` である。

    :3: プライベートウィンドウのみブロックする（既定）

    - `network.cookie.cookieBehavior` の値が `5` より小さい数値である。
    - `network.cookie.cookieBehavior.pbmode` の値が `5` である。

    :2: ブロックしない

    ABOUT_CONFIG

    - `network.cookie.cookieBehavior` の値が `5` より小さい数値である。
    - `network.cookie.cookieBehavior.pbmode` の値が `5` より小さい数値である。

Privacy-56: マスターパスワードの使用の強制

    :1: 強制する

    ABOUT_POLICIES

    - `PrimaryPassword` の値が `true` である。

    :2: 強制しない（既定）

    ABOUT_POLICIES

    - `PrimaryPassword` の値が `false` であるか、存在しない。

Privacy-57: 同一タブ・サイトにおけるマイクとカメラのアクセス

    :1: 60分以内であれば自動的に承認する (既定）

    ABOUT_CONFIG

    - "privacy.webrtc.deviceGracePeriodTimeoutMs" の値が `60000` である。

    :2: 独自のタイムアウトを設定する

    ABOUT_CONFIG

    - "privacy.webrtc.deviceGracePeriodTimeoutMs" の値が指定されたタイムアウト値 (単位はms) である

Privacy-58: クレジットカード情報の保存と自動入力

    :1: 保存・自動入力する (既定）

    - Firefoxを起動する。
    - テストケースの `creditcard.html` を開く。
    - ダミーのカード情報を入力して送信する。
    - **確認**
        - カード情報の保存を提案するポップアップが表示される。

    :2: 保存・自動入力しない

    - Firefoxを起動する。
    - テストケースの `creditcard.html` を開く。
    - ダミーのカード情報を入力して送信する。
    - **確認**
        - カード情報の保存を提案するポップアップが表示されない。

Privacy-59: 一時的な権限の許可を維持する時間

    :1: 1時間 (既定）

    ABOUT_CONFIG

    - "privacy.temporary_permission_expire_time_ms" の値が未定義か、または `3600000` である。

    :2: 任意の時間

    ABOUT_CONFIG

    - "privacy.temporary_permission_expire_time_ms" の値が指定の通りである。

Privacy-60: サブリソースに対するリファラ通知ポリシーの緩和の禁止

    :1: クロスオリジンで情報が通知されるような形でのポリシーの緩和を禁止する (既定）

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    {% if Privacy_44_4 %}
    - `about:config` を開く。
    - **確認**
        - `network.http.referer.disallowCrossSiteRelaxingDefault` の値が `true` で固定されている。
          (注: Privacy-44-4はリファラ通知ポリシーが最もゆるいため、ポリシーの緩和を禁止しようとする意図は意味をなさない。)
    {% else %}
    - テストケースリストのリンクから \
      `https://piro.sakura.ne.jp/test/iframe-referrer-policy-unsafe-url.html` \
      を開く。
    - **確認**
        - `https://whatsmyreferer.com/` を経由して `HTTP Referer : https://piro.sakura.ne.jp/` \
           とオリジンのみが表示される。
    - `about:config` を開く。
    - **確認(`https://whatsmyreferer.com`にアクセスできない場合)**
        - `network.http.referer.disallowCrossSiteRelaxingDefault` の値が `true` である。
    {% endif %}
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}

    :2: クロスオリジンで情報が通知されるような形でのポリシーの緩和を許可する

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - テストケースリストのリンクから \
      `https://piro.sakura.ne.jp/test/iframe-referrer-policy-unsafe-url.html` \
      を開く。
    - **確認**
        1. `https://whatsmyreferer.com/` を経由して `HTTP Referer : https://piro.sakura.ne.jp/test/iframe-referrer-policy-unsafe-url.html` \
           と完全なURLが表示される。
    - `about:config` を開く。
    - **確認(`https://whatsmyreferer.com`にアクセスできない場合)**
        - `network.http.referer.disallowCrossSiteRelaxingDefault` の値が `false` で固定されている。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}

Privacy-61: トップレベルのコンテンツに対するリファラ通知ポリシーの緩和の禁止

    :1: クロスオリジンで情報が通知されるような形でのポリシーの緩和を禁止する

    - Firefoxを起動する。
    - テストケースリストのリンクから \
      `https://labs.w0s.jp/http/referrer-policy/unsafe-url/` \
      を開く。
    - `(none)` のリンクをクリックする。
    - **確認**
        1. `https://whatsmyreferer.com/` を経由して `HTTP Referer : https://labs.w0s.jp/` \
           と表示される。

    :2: クロスオリジンで情報が通知されるような形でのポリシーの緩和を許可する (既定）

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - テストケースリストのリンクから \
      `https://labs.w0s.jp/http/referrer-policy/unsafe-url/` \
      を開く。
    - `(none)` のリンクをクリックする。
    - **確認**
        1. `https://whatsmyreferer.com/` を経由して `HTTP Referer : https://labs.w0s.jp/http/referrer-policy/unsafe-url/` \
           と表示される。
    - **確認(`https://whatsmyreferer.com`にアクセスできない場合)**
        - `network.http.referer.disallowCrossSiteRelaxingDefault.top_naviagtion` の値が `false` である。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}

Privacy-62: 厳格モードおよびプライベートブラウジング時の、サブリソースに対するリファラ通知ポリシーの緩和の禁止

    :1: クロスオリジンで情報が通知されるような形でのポリシーの緩和を禁止する (既定）

    {% if not MenuShortcut_3_1 %}
    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - プライベートウィンドウを開く。
    - プライベートウィンドウで、テストケースリストのリンクから \
      `https://piro.sakura.ne.jp/test/iframe-referrer-policy-unsafe-url.html` \
      を開く。
    - **確認**
        1. `https://whatsmyreferer.com/` を経由して `HTTP Referer : https://piro.sakura.ne.jp/` \
           とオリジンのみが表示される。
    - **確認(`https://whatsmyreferer.com`にアクセスできない場合)**
        - `network.http.referer.disallowCrossSiteRelaxingDefault.pbmode` の値が `true` である。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
    {% else %}
    - プライベートウィンドウの機能をMenuShortcut-3-1にて無効化しているため検証を省略する。
    {% endif %}

    :2: クロスオリジンで情報が通知されるような形でのポリシーの緩和を許可する

    {% if not MenuShortcut_3_1 %}
    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - プライベートウィンドウを開く。
    - プライベートウィンドウで、テストケースリストのリンクから \
      `https://piro.sakura.ne.jp/test/iframe-referrer-policy-unsafe-url.html` \
      を開く。
    - **確認**
        1. `https://whatsmyreferer.com/` を経由して `HTTP Referer : https://piro.sakura.ne.jp/test/iframe-referrer-policy-unsafe-url.html` \
           と完全なURLが表示される。
    - **確認(`https://whatsmyreferer.com`にアクセスできない場合)**
        - `network.http.referer.disallowCrossSiteRelaxingDefault.pbmode` の値が `false` で固定されている。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
    {% else %}
    - プライベートウィンドウの機能をMenuShortcut-3-1にて無効化しているため検証を省略する。
    {% endif %}

Privacy-63: 厳格モードおよびプライベートブラウジング時の、トップレベルのコンテンツに対するリファラ通知ポリシーの緩和の禁止

    :1: クロスオリジンで情報が通知されるような形でのポリシーの緩和を禁止する (既定）

    {% if not MenuShortcut_3_1 %}
    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - プライベートウィンドウを開く。
    - プライベートウィンドウで、テストケースリストのリンクから \
      `https://labs.w0s.jp/http/referrer-policy/unsafe-url/` \
      を開く。
    - `(none)` のリンクをクリックする。
    - **確認**
        1. `https://whatsmyreferer.com/` を経由して `HTTP Referer : https://labs.w0s.jp/` \
           と表示される。
    - **確認(`https://whatsmyreferer.com`にアクセスできない場合)**
        - `network.http.referer.disallowCrossSiteRelaxingDefault.pbmode.top_navigation` の値が `true` である。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
    {% else %}
    - プライベートウィンドウの機能をMenuShortcut-3-1にて無効化しているため検証を省略する。
    {% endif %}

    :2: クロスオリジンで情報が通知されるような形でのポリシーの緩和を許可する

    {% if not MenuShortcut_3_1 %}
    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - プライベートウィンドウを開く。
    - プライベートウィンドウで、テストケースリストのリンクから \
      `https://labs.w0s.jp/http/referrer-policy/unsafe-url/` \
      を開く。
    - `(none)` のリンクをクリックする。
    - **確認**
        1. `https://whatsmyreferer.com/` を経由して `HTTP Referer : https://labs.w0s.jp/http/referrer-policy/unsafe-url/` \
           と表示される。
    - **確認(`https://whatsmyreferer.com`にアクセスできない場合)**
        - `network.http.referer.disallowCrossSiteRelaxingDefault.pbmode.top_navigation` の値が `false` で固定されている。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
    {% else %}
    - プライベートウィンドウの機能をMenuShortcut-3-1にて無効化しているため検証を省略する。
    {% endif %}

Privacy-64: SameSite指定が無いCookieの取り扱い

    :1: クロスサイトでの送信を常に許可 (既定）

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル \
      `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} \
      （{{Application_6_2_special_profile_actual_path}}）{% endif %} \
      を削除する。
    - Firefoxを起動する。
    - テストケースリストのリンクから \
      `https://codepen.io/isystk/pen/VwLEzBJ` \
      を開く。
    - ページ下部のフレーム内の「タグによるアクセス」というラベル配下のリンクをクリックする。
    - ページを再読み込みする。
    - ページ下部のフレーム内の「タグによるアクセス」というラベル配下のリンクをもう1度クリックする。
    - **確認**
        - 遷移後のページの `noCokkie` と `noneCokkie` の両方に `◯` が表示されている。

    :2: クロスサイトでの送信をサブリソースに対しては禁止する

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル \
      `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} \
      （{{Application_6_2_special_profile_actual_path}}）{% endif %} \
      を削除する。
    - Firefoxを起動する。
    - テストケースリストのリンクから \
      `https://codepen.io/isystk/pen/VwLEzBJ` \
      を開く。
    - ページ下部のフレーム内の「タグによるアクセス」というラベル配下のリンクをクリックする。
    - ページを再読み込みする。
    - ページ下部のフレーム内の「タグによるアクセス」というラベル配下のリンクをもう1度クリックする。
    - **確認**
        - 遷移後のページの `noCokkie` に `◯` が表示されていない。

    :3: クロスサイトでの送信をサブリソースに対しては禁止し、特定サイトでのみクロスサイトでの送信を常に許可

    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル \
      `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} \
      （{{Application_6_2_special_profile_actual_path}}）{% endif %} \
      を削除する。
    - Firefoxを起動する。
    - テストケースリストのリンクから \
      `https://codepen.io/isystk/pen/VwLEzBJ` \
      を開く。
    - ページ下部のフレーム内の「タグによるアクセス」というラベル配下のリンクをクリックする。
    - ページを再読み込みする。
    - ページ下部のフレーム内の「タグによるアクセス」というラベル配下のリンクをもう1度クリックする。
    - **確認**
        - 遷移後のページの `noCokkie` に `◯` が表示されていない。
    - ポリシー設定を変更し `demo.isystk.com` をクロスサイトでのCookie送信許可サイトに加える。
    - 今バージョンのメタインストーラで導入したFirefoxのユーザープロファイル \
      `{{special_profile_path}}` {%if Application_6_2_special_profile_actual_path %} \
      （{{Application_6_2_special_profile_actual_path}}）{% endif %} \
      を削除する。
    - Firefoxを起動する。
    - テストケースリストのリンクから \
      `https://codepen.io/isystk/pen/VwLEzBJ` \
      を開く。
    - ページ下部のフレーム内の「タグによるアクセス」というラベル配下のリンクをクリックする。
    - ページを再読み込みする。
    - ページ下部のフレーム内の「タグによるアクセス」というラベル配下のリンクをもう1度クリックする。
    - **確認**
        - 遷移後のページの `noCokkie` と `nonoeCokkie` の両方に `◯` が表示されている。

Privacy-65: 履歴データベースの有効化

    :1: 有効（既定）

    - Firefoxを起動する。
    - 任意のウェブサイトにアクセスする。
    - **確認**
        - メニューバーの「履歴」にアクセスしたサイトの履歴が残っている。

    :2: 無効

    - Firefoxを起動する。
    - 任意のウェブサイトにアクセスする。
    - **確認**
        - メニューバーの「履歴」にアクセスしたサイトの履歴が残っていない。

Privacy-66: トラッキング防止時のクロスサイトのトラッキング用URLパラメーターの扱い

    :1: 削除する（既定）

    ABOUT_CONFIG

    - `privacy.query_stripping.enabled` の値が `false` である。
    - `privacy.query_stripping.enabled.pbmode` の値が `false` である。

    :2: 削除しない

    ABOUT_CONFIG

    - `privacy.query_stripping.enabled` の値が `true` である。
    - `privacy.query_stripping.enabled.pbmode` の値が `true` である。

Privacy-67: トラッカーのより強力なブロック

    :1: ブロックする

    ABOUT_CONFIG

    - `privacy.annotate_channels.strict_list.enabled` の値が `true` である。

    :2: ブロックしない（既定）

    ABOUT_CONFIG

    - `privacy.annotate_channels.strict_list.enabled` の値が `false` である。

Privacy-68: プライベートウィンドウでのトラッカーのより強力なブロック

    :1: ブロックする（既定）

    ABOUT_CONFIG

    - `privacy.annotate_channels.strict_list.pbmode.enabled` の値が `true` である。

    :2: ブロックしない

    ABOUT_CONFIG

    - `privacy.annotate_channels.strict_list.pbmode.enabled` の値が `false` である。

Privacy-69: 住所情報の保存

    :1: 許可された地域で保存する

    - Firefoxを起動する。
    - テストケースの `address.html` を開く。
    - ダミーの住所情報を入力して送信する。
    - **確認**
        - 住所情報の保存を提案するポップアップが表示される。

    :2: 保存しない

    - Firefoxを起動する。 (既定）
    - テストケースの `address.html` を開く。
    - ダミーの住所情報を入力して送信する。
    - **確認**
        - 住所情報の保存を提案するポップアップが表示されない。

Privacy-70: [廃止] 「Do Not Sell」ヘッダの送出の可否

    :1: [廃止] 送出する

    [廃止]

    :2: [廃止] 送出しない（既定）

    [廃止] 

Privacy-71: Privacy Preserving Attribution APIの有効化

    :1: 一部のWebサイトで有効化する（既定）

    OPTIONS

    - 「プライバシーとセキュリティ」→「ウェブサイトの広告設定」→「プライバシー保護された広告解析をウェブサイトに許可する」にチェックが入っている。

    :2: 無効化する

    OPTIONS

    - 「プライバシーとセキュリティ」→「ウェブサイトの広告設定」→「プライバシー保護された広告解析をウェブサイトに許可する」のチェックが外れている。

Privacy-72: ユーザー操作で新しくウィンドウが開かれたときのサードパーティーコンテンツに対するストレージアクセスの可否

    :1: 暗黙的に許可を与える

    ABOUT_CONFIG

    - `privacy.restrict3rdpartystorage.heuristic.redirect` の値が `true` である。

    :2: 明示的な許可を必要とする（既定）

    ABOUT_CONFIG

    - `privacy.restrict3rdpartystorage.heuristic.redirect` の値が `false` である。

Privacy-73: グローバルプライバシーコントロールによる、ユーザーデータの販売や共有の拒否のWebサイトへの通知

    :1: 通知する

    OPTIONS

    - 「プライバシーとセキュリティ」→「ブラウザープライバシー」→「ウェブサイトのプライバシー設定」で「ウェブサイトにユーザーデータの販売や共有の拒否を通知する」にチェックが入っている。

    :2: 通知しない（既定）

    OPTIONS

    - 「プライバシーとセキュリティ」→「ブラウザープライバシー」→「ウェブサイトのプライバシー設定」で「ウェブサイトにユーザーデータの販売や共有の拒否を通知する」のチェックが外れている。

Privacy-74: 拡張機能のコンテンツスクリプトを利用したユーザー追跡の防止

    :1: 防止する

    ABOUT_CONFIG

    - `privacy.antitracking.isolateContentScriptResources` の値が `true` である。

    :2: 防止しない（既定）

    ABOUT_CONFIG

    - `privacy.antitracking.isolateContentScriptResources` の値が `false` である。

Privacy-75: プライベートブラウジングモードの使用

    :1: 使用を許可（既定）

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「新しいプライベートウィンドウ」がメニュー内にある。
    - 「新しいプライベートウィンドウ」を選択する。
    - **確認**
        - プライベートウィンドウ固有の外観のウィンドウが開かれ、最初のタブのラベルが「新しいプライベートタブ」となっている。

    :2: 使用を禁止

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「新しいプライベートウィンドウ」がメニュー内に無い。

    :3: 使用を強制

    - Firefoxを起動する。
    - パネルメニューを開く。
    - **確認**
        - 「新しいプライベートウィンドウ」がメニュー内に無い。
    - 「新しいプライベートウィンドウ」を選択する。
    - **確認**
        - 通常の外観のウィンドウが開かれ、最初のタブのラベルが「新しいタブ」となっている。

Privacy-76: サードパーティーCookieの受け容れ可否

    :1: 受け容れる（既定）

    - Firefoxを起動する。
    - テストケースリストのリンクから `https://alanhogan.github.io/web-experiments/3rd/third-party-cookies.html` を開く。
    - **確認**
        - 「Third party cookies are functioning in your browser.」と表示される。

    :2: 拒否する

    - Firefoxを起動する。
    - テストケースリストのリンクから `https://alanhogan.github.io/web-experiments/3rd/third-party-cookies.html` を開く。
    - **確認**
        - 「Third party cookies appear to be disabled.」と表示される。

Privacy-77: Bounce Tracking（中間サイトを介したトラッキング）の可否

    :1: 受け容れる（既定）

    ABOUT_CONFIG

    - `privacy.bounceTrackingProtection.mode` の値が `3` である。

    :2: 拒否する

    ABOUT_CONFIG

    - `privacy.bounceTrackingProtection.mode` の値が `1` である。

Privacy-78: SmartBlockによるソーシャルメディアの埋め込みコンテンツの広範なブロック

    :1: ブロックする

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `network.dns.notifyResolution`（真偽型）：`true`
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューで「その他のツール」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - 以下のコードをコンソール内で実行する。
      
              TrackingProtection.annotationsLevel2Enabled 
      
    - **確認**
        - `true` というログがブラウザーコンソールに出力される。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}

    :2: ブロックしない（既定）

    {%if Security_9_3 %}
    - ポリシー設定から `BlockAboutConfig` を削除し、`about:config` を一時的に有効化しておく。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から `DisableDeveloperTools` を削除し、開発ツールを一時的に有効化しておく。
      {% endif %}
    - Firefoxを起動する。
    - `about:config` を開く。
    - 以下の設定を行う（設定値が既に指定の通りであればそのままとし、既存の値がない場合は新規に作成する）。
        - `network.dns.notifyResolution`（真偽型）：`true`
        - `devtools.chrome.enabled`（真偽型）：`true`
    - パネルメニューで「その他のツール」をクリックして、サブメニューの「ブラウザーコンソール」をクリックする。
    - 以下のコードをコンソール内で実行する。
      
              TrackingProtection.annotationsLevel2Enabled 
      
    - **確認**
        - `false` というログがブラウザーコンソールに出力される。
      {%if Security_9_3 %}
    - ポリシー設定から一時的に削除した `BlockAboutConfig` を元に戻す。
      {% endif %}
      {%if DisableDeveloperTools %}
    - ポリシー設定から一時的に削除した `DisableDeveloperTools` を元に戻す。
      {% endif %}
